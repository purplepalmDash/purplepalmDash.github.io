<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>LinuxTips9 &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><meta name=description content="Linux Tips 9"><meta name=keywords content="Linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>很惭愧，就做了一点微小的工作</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=post><h1>LinuxTips9</h1><p align=right><a href=javascript:genPostShot()>TurnToJPG --> <i class="fa fa-camera-retro fa-2x"></i></a><a id=test></a></p><hr><span class=post-date>May 21, 2018<br><a class=a_cat href=http://purplepalmdash.github.io/categories/linuxtips>LinuxTips</a></span><div id=_toc class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#1-build-maven-project>1. Build maven project</a></li><li><a href=#2-sed-replace>2. sed replace</a></li><li><a href=#3-get-ip-for-ubuntu>3. get ip for ubuntu</a></li><li><a href=#4-view-systemd-logs>4. view systemd logs</a></li><li><a href=#5-disable-unattended-upgrades>5. Disable unattended upgrades</a></li><li><a href=#6-rhel-subscription>6. rhel subscription</a></li><li><a href=#7-anaconda-issue>7. anaconda issue</a></li><li><a href=#8-kismatic-reset>8. kismatic reset</a></li><li><a href=#9-kubernetes-pkgs>9. kubernetes pkgs</a></li><li><a href=#10-samba-in-archlinux>10. samba in ArchLinux</a></li><li><a href=#11-tar-with-pigz>11. tar with pigz</a></li><li><a href=#12-tips-for-centos>12. tips for centos</a></li><li><a href=#13-tmpfs-for-debian>13. tmpfs for debian</a></li><li><a href=#14-kong-ingress-configuration>14. kong ingress configuration</a></li><li><a href=#15-auto-restart-pdnsd>15. Auto Restart pdnsd</a></li><li><a href=#16-python-simple-http-server>16. python simple http server</a></li><li><a href=#17-cnpm-install-error>17. cnpm install error</a></li><li><a href=#18-dnscrypt>18. dnscrypt</a></li><li><a href=#19-ubuntu-1804-vnc>19. Ubuntu 18.04 vnc</a></li><li><a href=#20-uefi-for-archlinux-qemu>20. uefi for archlinux qemu</a></li><li><a href=#21-unlock-proxmox>21. unlock proxmox</a></li><li><a href=#22-back-to-work>22. Back to Work</a></li><li><a href=#23-debian-upgrade-kernel>23. Debian upgrade kernel</a></li><li><a href=#24-samba-issue>24. samba issue</a></li><li><a href=#25-unzip-iconv>25. unzip iconv</a></li><li><a href=#26-quickly-setup-nodejs-dev>26. Quickly Setup NodeJS Dev</a></li><li><a href=#27-registry-settinginsecure>27. registry setting(insecure)</a></li><li><a href=#28-paccache-saveing>28. paccache Saveing</a></li><li><a href=#29-kvmvmware-issue>29. kvm/vmware issue</a></li><li><a href=#30-ansible-for-installing-nfs-client>30. ansible for installing nfs-client</a></li><li><a href=#31-chartmuseum>31. chartmuseum</a></li><li><a href=#32-docker-volume-rm>32. docker volume rm</a></li><li><a href=#33-generate-crtkey-in-one-line>33. Generate crt/key in one line</a></li><li><a href=#34-ubuntu-server-gui>34. Ubuntu Server GUI</a></li><li><a href=#35-vncserver>35. vncserver</a></li><li><a href=#36-internet-sharing>36. Internet Sharing</a></li><li><a href=#37-time-sync-in-archlinux>37. time-sync in archlinux</a></li><li><a href=#38-combine-pdf>38. Combine pdf</a></li><li><a href=#39-crontab-and-notify-send>39. crontab and notify-send</a></li><li><a href=#40-unxz>40. unxz</a></li><li><a href=#41-ansible-execute-time>41. ansible execute time</a></li><li><a href=#42-echo-server>42. echo server</a></li><li><a href=#43-reconfigure-keyboard>43. reconfigure keyboard</a></li><li><a href=#44-raid-issue>44. raid issue</a></li><li><a href=#45-vagrant-libvirt>45. vagrant-libvirt</a></li><li><a href=#46-apt-auto-update-disable>46. apt auto update disable</a></li><li><a href=#47-openssl-inspect-lifetime-of-crt>47. openssl inspect lifetime of crt</a></li><li><a href=#48-vagrant-issue>48. Vagrant issue</a></li><li><a href=#49-wrapped-lines-in-vim>49. wrapped lines in vim</a></li><li><a href=#51-format-several-disk>51. format several disk</a></li><li><a href=#52-auto-change-password>52. Auto Change password</a></li><li><a href=#53-rsync-sync-repo>53. rsync sync repo</a></li><li><a href=#54-pool-start>54. pool-start</a></li><li><a href=#55-minikube-start-specify-cpumemdisk>55. minikube start specify cpu/mem/disk</a></li><li><a href=#56-combine-lines-under-linux>56. Combine lines under linux</a></li><li><a href=#57-prometheus-for-k8s>57. prometheus for k8s</a></li><li><a href=#58-virtualbox-tips>58. virtualbox tips</a></li><li><a href=#59-libvirts-bus-issue>59. libvirt&rsquo;s bus issue</a></li><li><a href=#60-minimum-glusterfs-nodes>60. Minimum glusterfs nodes</a></li><li><a href=#61-history-without-number>61. history without number</a></li><li><a href=#62-tr-replace-newline>62. tr replace newline</a></li><li><a href=#63-two-file-difference>63. two file difference</a></li><li><a href=#64-vimdiff-tips>64. vimdiff tips</a></li><li><a href=#65-pactree>65. pactree</a></li><li><a href=#66-wifi-list>66. wifi list</a></li><li><a href=#67-sed-disable-swap>67. sed disable swap</a></li><li><a href=#68-python-split>68. python split</a></li><li><a href=#69-proxmox-configuration>69. proxmox Configuration</a></li><li><a href=#70-proxmox-inner-network>70. proxmox inner network</a></li><li><a href=#71-vagrant-libvirt>71. vagrant-libvirt</a></li><li><a href=#72-beyond-compare-linux>72. beyond compare Linux</a></li><li><a href=#73-forwarding-in-win>73. forwarding in Win</a></li></ul></li></ul></nav></div><h3 id=1-build-maven-project>1. Build maven project</h3><p>For building the class, do <code>mvn compile</code>, for building the jar file, do <code>mvn package</code>, then you could get the jar under the <code>target</code> folder.</p><h3 id=2-sed-replace>2. sed replace</h3><p>via following commands:</p><pre><code># sed s/10.168.100.145/192.192.189.1/&lt;/home/dash/docker-compose.yml
</code></pre><h3 id=3-get-ip-for-ubuntu>3. get ip for ubuntu</h3><p>Ubuntu 14.04 ~ 18.04, via following command:</p><pre><code>hostname -I | awk '{print $1}'
</code></pre><h3 id=4-view-systemd-logs>4. view systemd logs</h3><p>via following command:</p><pre><code># journalctl -u service-name.service -b
</code></pre><h3 id=5-disable-unattended-upgrades>5. Disable unattended upgrades</h3><p>Under Ubuntu18.04/16.04, could do :</p><pre><code># systemctl disable unattended-upgrade.service
</code></pre><h3 id=6-rhel-subscription>6. rhel subscription</h3><p>Via following steps:</p><pre><code>sudo subscription-manager remove --all
sudo subscription-manager unregister
sudo subscription-manager clean

Now re-register the system, attach the subscriptions - execute these commands :

sudo subscription-manager register
sudo subscription-manager refresh
sudo subscription-manager attach --auto

Here are the commands to see which repos are enabled and what can be added :

Execute sudo subscription-manager repos --list-enabled to see all actually enabled subscriptions.
Execute sudo subscription-manager repos --list to see all subscriptions that are available for you.
Execute sudo subscription-manager repos --enable &lt;repo&gt; if you want to add additional repos.
</code></pre><h3 id=7-anaconda-issue>7. anaconda issue</h3><p>anaconda build rhel7 custom image Issue:</p><pre><code># dracut module 'anaconda' cannot be found or installed
</code></pre><p>how to solve?</p><h3 id=8-kismatic-reset>8. kismatic reset</h3><p>via:</p><pre><code>./kismatic reset
</code></pre><h3 id=9-kubernetes-pkgs>9. kubernetes pkgs</h3><p>Install via:</p><pre><code># vim /etc/yum.repos.d/kubernetes.repo
 [kubernetes]
 name=Kubernetes
 baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
 enabled=1
 gpgcheck=0
 repo_gpgcheck=0
</code></pre><h3 id=10-samba-in-archlinux>10. samba in ArchLinux</h3><pre><code># pacman -S samba
# wget https://git.samba.org/samba.git/?p=samba.git;a=blob_plain;f=examples/smb.conf.default;hb=HEAD
# cp git..xxx /etc/samba/smb.conf
# vim /etc/samba/smb.conf
   log file = /var/log/samba/%m.log
[myshare]
   comment = Mary's and Fred's stuff
   path = /var1/Nov14
   valid users = dash
   public = no
   writable = yes
   printable = no
   create mask = 0765
# systemctl enable smb
# systemctl enable nmb
# systemctl start smb
# systemctl start nmb
</code></pre><h3 id=11-tar-with-pigz>11. tar with pigz</h3><p>With pigz compression:</p><pre><code>tar cf - paths-to-archive | pigz -9 -p 32 &gt; archive.tar.gz

</code></pre><h3 id=12-tips-for-centos>12. tips for centos</h3><ol><li>install from iso</li><li>sed the ip address.(isomaster)</li><li>pigz package needed to be installed first. (isomaster)</li></ol><h3 id=13-tmpfs-for-debian>13. tmpfs for debian</h3><p>via :</p><pre><code># vim /etc/fstab
.....

tmpfs	/tmp	tmpfs	nodev,nosuid,size=8G 0	0
</code></pre><h3 id=14-kong-ingress-configuration>14. kong ingress configuration</h3><p>Rewrite ingress rulers:</p><pre><code>apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: anagram.api
  annotations:
    ingress.kubernetes.io/rewrite-target: &quot;/&quot;
spec:
  rules:
  - host: anagram.api
    http:
      paths:
      - path: /external
        backend:
          serviceName: anagram-svc
          servicePort: 80
---
apiVersion: configuration.konghq.com/v1
kind: KongIngress
metadata:
  name: anagram.api
proxy:
  path: /
route:
  strip_path: true
</code></pre><h3 id=15-auto-restart-pdnsd>15. Auto Restart pdnsd</h3><p>The script for start pdnsd:</p><pre><code># cat /bin/pdnsd.sh 
    touch /tmp/aaa.txt
    if [[ $(ps -ef | grep -v grep | grep pdnsd) ]]; then
    	echo &quot;pdnsd alive&quot;&gt;/tmp/aaa.txt
    else
    	echo &quot;not alive&quot;&gt;/tmp/aaa.txt
    	systemctl start pdnsd
    fi
</code></pre><p>Add this script into crontab:</p><pre><code># crontab -e
@reboot sleep 60 &amp;&amp; /bin/pdnsd.sh
</code></pre><h3 id=16-python-simple-http-server>16. python simple http server</h3><p>python 3 syntax:</p><pre><code>python -m http.server 8000
</code></pre><h3 id=17-cnpm-install-error>17. cnpm install error</h3><p>As normal user, you didn&rsquo;t have the priviledge for making soft link for cnpm.</p><p>As rooot user, do following:</p><pre><code>$ sudo npm cache clean --force
$ sudo npm install -g cnpm --registry=https://registry.npm.taobao.org
$ which cnpm
/usr/bin/cnpm

</code></pre><h3 id=18-dnscrypt>18. dnscrypt</h3><p>start via, better enable it:</p><pre><code>sudo systemctl start dnscrypt-proxy.service
</code></pre><h3 id=19-ubuntu-1804-vnc>19. Ubuntu 18.04 vnc</h3><p>Via following steps:</p><pre><code>install these packages

# apt-get install gnome-panel gnome-settings-daemon metacity nautilus gnome-terminal
and use this xstartup file

#!/bin/sh

export XKL_XMODMAP_DISABLE=1
unset SESSION_MANAGER
unset DBUS_SESSION_BUS_ADDRESS

[ -x /etc/vnc/xstartup ] &amp;&amp; exec /etc/vnc/xstartup
[ -r $HOME/.Xresources ] &amp;&amp; xrdb $HOME/.Xresources
xsetroot -solid grey
vncconfig -iconic &amp;

gnome-panel &amp;
gnome-settings-daemon &amp;
metacity &amp;
nautilus &amp;
gnome-terminal &amp;
</code></pre><p>But you will add some tips:</p><pre><code>$ vim /usr/bin/gnome-panel-delay 
!/bin/sh
sleep 4 &amp;&amp; gnome-panel
</code></pre><p>Replace <code>gnome-panel</code> with <code>gnome-panel-delay</code>.</p><h3 id=20-uefi-for-archlinux-qemu>20. uefi for archlinux qemu</h3><p>Install via:</p><pre><code>$ sudo pacman -S ovmf
$ sudo vim /etc/libvirt/qemu.conf
user=&quot;root&quot;
group=&quot;root&quot;
nvram = [
    &quot;/usr/share/ovmf/x64/OVMF_CODE.fd:/usr/share/ovmf/x64/OVMF_VARS.fd&quot;
]
$ sudo systemctl restart libvirtd
</code></pre><h3 id=21-unlock-proxmox>21. unlock proxmox</h3><p>via following command:</p><pre><code># qm unlock vm_id
</code></pre><h3 id=22-back-to-work>22. Back to Work</h3><p>Edit <code>/etc/systemd/network/MyBridge.network</code>, change the ip address, then
restart the networkd service via:</p><pre><code># systemclt restart systemd-networkd.service
</code></pre><p>Then your briged br0 will turn back to the ip address you just changed.</p><h3 id=23-debian-upgrade-kernel>23. Debian upgrade kernel</h3><p>Via following commands:</p><pre><code># echo &quot;deb http://ftp.debian.org/debian stretch-backports main&quot; | tee -a /etc/apt/sources.list &gt; /dev/null
# apt-get update
# apt-cache search linux-image
# apt-get -t stretch-backports install linux-image-4.11.0-0.bpo.1-amd64
</code></pre><h3 id=24-samba-issue>24. samba issue</h3><p>From samba 4.8, the smbd, changed to smb, nmbd changed to nmb, so systemctl
will changd to smb/nmb</p><h3 id=25-unzip-iconv>25. unzip iconv</h3><p>Chinese unzip:</p><pre><code>$ unzip-iconv
$ unzip -O cp936  xxxx.zip
</code></pre><p>thus you will get the chinese coded file extracted.</p><h3 id=26-quickly-setup-nodejs-dev>26. Quickly Setup NodeJS Dev</h3><p>In Conoha:</p><pre><code># docker run -it -p 5000:5000 ubuntu:latest /bin/bash
# apt-get update
# apt-get -y install vim
Change archive.ubuntu.com to jp.archive.ubuntu.com
# apt-get update
# apt-get install -y nodejs npm
# cd ~
# mkdir Code
# cd Code
# mkdir node
# npm config set prefix=$HOME/node
# export PATH=$HOME/node/bin:$PATH
# npm install -g express
# npm install -g express-generator
# which express
# exporess defcon
# cd defcon/
# npm install -d
# npm install socket.io express  
# npm install -d
</code></pre><p>You should follow</p><p><a href=https://github.com/robdodson/defcon>https://github.com/robdodson/defcon</a></p><p>Install with ejs template enabled:</p><pre><code># express -v ejs dash
</code></pre><h3 id=27-registry-settinginsecure>27. registry setting(insecure)</h3><p>Xenial , via:</p><pre><code>Edit /etc/docker/daemon.json and update the key &quot;insecure-registries&quot;.
e.g.
    {
        &quot;insecure-registries&quot; : [&quot;10.84.34.155:5000&quot;]
    }
</code></pre><h3 id=28-paccache-saveing>28. paccache Saveing</h3><p>Take care the directory size:</p><pre><code># pacman du -hs pkg 
31G	pkg
# pacman du -hs pkg 
9.4G	pkg
# pacman du -hs pkg 
4.1G	pkg
</code></pre><p>By following command you could saving the disk space(keep 3 or keep 1):</p><pre><code># sudo paccache -r -k 3
# sudo paccache -r -k 1 
</code></pre><h3 id=29-kvmvmware-issue>29. kvm/vmware issue</h3><p>kvm will be black-listed via vmware, solved via:</p><pre><code># cat /etc/modprobe.d/vmware.conf 
blacklist kvm
blacklist kvm-amd   # For AMD CPUs
blacklist kvm-intel # For Intel CPUs
</code></pre><p>Uninstall vmware via:</p><pre><code># vmware-installer -l
Product Name         Product Version     
==================== ====================
vmware-workstation   12.0.0.2985596      
# vmware-installer -u vmware-workstation --required
</code></pre><p>Remove the service:</p><pre><code># rm /etc/systemd/system/vmware.service
# rm /etc/systemd/system/vmware-usbarbitrator.service
</code></pre><h3 id=30-ansible-for-installing-nfs-client>30. ansible for installing nfs-client</h3><p>Install methods:</p><pre><code># apt-get install nfs-common
# vim local.ini
# ansible-playbook -i local.ini nfsclient.yaml --extra-vars &quot;@roles/nfs-client/defaults/all.yaml&quot;
</code></pre><h3 id=31-chartmuseum>31. chartmuseum</h3><p>Delete and upload again:</p><pre><code>#  curl -X DELETE portus.teligen.com:8988/api/charts/gitlab-runner/0.1.31
# curl --data-binary &quot;@gitlab-runner-0.1.31.tgz&quot; http://portus.teligen.com:8988/api/charts
</code></pre><h3 id=32-docker-volume-rm>32. docker volume rm</h3><p>Via following command:</p><pre><code># docker volume ls | sed -n '1!p' |awk {'print $2'} | xargs -I % docker volume rm %
</code></pre><h3 id=33-generate-crtkey-in-one-line>33. Generate crt/key in one line</h3><p>Via following command:</p><pre><code># openssl req -new -newkey rsa:4096 -days 365 -nodes -x509     -subj &quot;/C=US/ST=Denial/L=Springfield/O=Dis/CN=www.example.com&quot;     -keyout www.example.com.key  -out www.example.com.cert
</code></pre><h3 id=34-ubuntu-server-gui>34. Ubuntu Server GUI</h3><p>Install tasksel via:</p><pre><code># apt-get install -y tasksel
# tasksel --list
</code></pre><p>Install Ubuntu mate core via:</p><pre><code># tasksel install ubuntu-mate-core
# service lightdm start
</code></pre><p>Or Ubuntu/xubuntu-core/Lubuntu-core, etc, you could choose from the tasksel
list.</p><h3 id=35-vncserver>35. vncserver</h3><p>For ArchLinux:</p><pre><code>export XKL_XMODMAP_DISABLE=1
#exec startxfce4
exec startlxde

</code></pre><h3 id=36-internet-sharing>36. Internet Sharing</h3><p>For ArchLinux, 2 cards, enp0s29u1u2u7 is the card for connecting the internet,
while the enp0s29u1u2u6 is the card for intranet. :</p><pre><code>➜  ~ sudo iptables -t nat -A POSTROUTING -o enp0s29u1u2u7 -j MASQUERADE
➜  ~ sudo iptables -A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
➜  ~ sudo iptables -A FORWARD -i enp0s29u1u2u6 -o enp0s29u1u2u7 -j ACCEPT

</code></pre><h3 id=37-time-sync-in-archlinux>37. time-sync in archlinux</h3><p>ArchLinux ntp date.</p><pre><code># vim  /etc/systemd/timesyncd.conf
[Time]
NTP=0.arch.pool.ntp.org 1.arch.pool.ntp.org 2.arch.pool.ntp.org 3.arch.pool.ntp.org
FallbackNTP=0.pool.ntp.org 1.pool.ntp.org 0.fr.pool.ntp.org0.arch.pool.ntp.org 1.arch.pool.ntp.org 2.arch.pool.ntp.org 3.arch.pool.ntp.org
# sudo systemctl enable systemd-timesyncd
# timedatectl show-timesync --all
</code></pre><h3 id=38-combine-pdf>38. Combine pdf</h3><p>The filename contains Chinese, so I have to do like following:</p><pre><code>$ ls -tr *.pdf | awk -v q=&quot;'&quot; {'print q$0q'}&gt;list.txt
</code></pre><p>Then edit the list.txt</p><p><img src=/images/2018_10_26_11_38_59_945x451.jpg alt=/images/2018_10_26_11_38_59_945x451.jpg></p><p>Then your generated Combine.</p><pre><code>$ pdfunite in-1.pdf in-2.pdf in-n.pdf out.pdf
</code></pre><p>Your generated out.pdf contains all of the pdfs.</p><h3 id=39-crontab-and-notify-send>39. crontab and notify-send</h3><p>Create <code>/bin/touchXdbus.sh</code> for getting the DBUS Session bus address:</p><pre><code>#!/bin/sh

touch $HOME/.dbus/Xdbus
chmod 600 $HOME/.dbus/Xdbus
env | grep DBUS_SESSION_BUS_ADDRESS &gt; $HOME/.dbus/Xdbus
echo 'export DBUS_SESSION_BUS_ADDRESS' &gt;&gt; $HOME/.dbus/Xdbus
</code></pre><p>On Awesome startup, use <code>run_once</code> function for calling it:</p><pre><code>$ vim ~/.config/awesome/rc.lua
run_once(&quot;/bin/touchXdbus.sh&quot;)
</code></pre><p>Now in your crontab task you have to write like following:</p><pre><code>$ crontab -l
10 9-18 * * * /bin/notify.sh
$ cat /bin/notify.sh 
    #!/bin/sh
    + if [ -r &quot;$HOME/.dbus/Xdbus&quot; ]; then
    +   . &quot;$HOME/.dbus/Xdbus&quot;
    + fi
    current_time=`date`
    filename=&quot;/home/dash/tasks.txt&quot;
    filecontent=`cat $filename`
    
    #### Until you click it, you won't get this window vanish #####
    notify-send -u critical -t 0 &quot;$current_time, Stand UP, Boy&quot; &quot;$filecontent&quot;

</code></pre><p>Now your notify-send will run properly.</p><h3 id=40-unxz>40. unxz</h3><p>Use unxz for uncompress xz compressed file.</p><h3 id=41-ansible-execute-time>41. ansible execute time</h3><p>Add following configurations to ansible.cfg:</p><pre><code>callback_whitelist = profile_tasks, timer
</code></pre><h3 id=42-echo-server>42. echo server</h3><p>Run python echo server under kubernetes via:</p><pre><code># kubectl run myecho --image=echoserverpy:latest --replicas=3
# kubectl expose deployment myecho --port=31113
</code></pre><p>Edit for exposing UDP 31113 Port:</p><p><img src=/images/2018_11_29_10_58_51_392x318.jpg alt=/images/2018_11_29_10_58_51_392x318.jpg></p><p>Add NodePort definition:</p><p><img src=/images/2018_11_29_11_00_40_436x380.jpg alt=/images/2018_11_29_11_00_40_436x380.jpg></p><h3 id=43-reconfigure-keyboard>43. reconfigure keyboard</h3><p>reconfigure keyboard on ubuntu is :</p><pre><code># sudo dpkg-reconfigure keyboard-configuration
</code></pre><h3 id=44-raid-issue>44. raid issue</h3><p>Deletes:</p><pre><code>#/opt/MegaRAID/MegaCli/MegaCli64 -CfgLdDel -L1 -a0
</code></pre><p>List:</p><pre><code>MegaCli -LDInfo -LALL -aAll 【显示所有逻辑磁盘组信息】
MegaCli -PDList -aAll 【显示所有的物理信息】
</code></pre><h3 id=45-vagrant-libvirt>45. vagrant-libvirt</h3><p>Install via:</p><pre><code># yaourt vagrant-libvirt
# vagrant plugin install /opt/vagrant/embedded/gems/cache/vagrant-libvirt-0.0.45.gem
# vagrant plugin install vagrant-mutate
#  vagrant plugin list
vagrant-libvirt (0.0.45, global)
  - Version Constraint: 0.0.45
vagrant-mutate (1.2.0, global)
</code></pre><p>After upgrading, do following:</p><pre><code># vagrant plugin install /opt/vagrant/embedded/gems/cache/vagrant-libvirt-0.0.45.gem
# vagrant plugin install vagrant-mutate
# yaourt vagrant-libvirt
</code></pre><p>Then all of your plugins will work properly.</p><h3 id=46-apt-auto-update-disable>46. apt auto update disable</h3><p>disable via:</p><pre><code>systemctl stop apt-daily.timer
systemctl disable apt-daily.timer
systemctl disable apt-daily.service
systemctl stop apt-daily-upgrade.timer
systemctl disable apt-daily-upgrade.timer
systemctl disable apt-daily-upgrade.service
Or

systemctl disable --now apt-daily{,-upgrade}.{timer,service}
</code></pre><h3 id=47-openssl-inspect-lifetime-of-crt>47. openssl inspect lifetime of crt</h3><p>Via following commands:</p><pre><code>openssl x509 -in server.crt -noout -dates

</code></pre><h3 id=48-vagrant-issue>48. Vagrant issue</h3><p>Vagrant-libvirt, sometimes you have to manually build the ruby-libvirt plugin,
and copy the correspoding so file into the /opt/vagrant</p><h3 id=49-wrapped-lines-in-vim>49. wrapped lines in vim</h3><p>via following commands:</p><pre><code>
First set your vim so that it understands that you want 80 characters:

:set tw=80
then, hilight the line:

V
and make vim reformat it:

gq
shareedit
</code></pre><h3 id=51-format-several-disk>51. format several disk</h3><p>Using following command:</p><pre><code>set -e
set -x
for i in b c d e f g h i j k l; do
sudo fdisk -u /dev/vd${i}&lt;&lt;EOF
n
p
1


w
EOF
done
</code></pre><p>This command will format several disks, as you like.</p><h3 id=52-auto-change-password>52. Auto Change password</h3><p>Change password via following commands:</p><pre><code>

$ openssl passwd -1 -salt 5RPVAd clear-text-passwd43

$1$5RPVAd$vgsoSANybLDepv2ETcUH7.

Then, copy the encrypted string to usermod. Make sure to wrap it with single quote.

$ usermod -p '$1$5RPVAd$vgsoSANybLDepv2ETcUH7.' root

Check it out in shadow file.

$ grep root /etc/shadow
</code></pre><h3 id=53-rsync-sync-repo>53. rsync sync repo</h3><p>syncing the ceph repository via following command:</p><pre><code># rsync -av --exclude &quot;ceph-debuginfo&quot; rsync://mirrors.ustc.edu.cn/ceph/rpm-luminous/el7/  `pwd`
# rsync -av --exclude &quot;ceph-debuginfo&quot; rsync://rsync.mirrors.ustc.edu.cn/ceph/rpm-luminous/el7/  ./

</code></pre><h3 id=54-pool-start>54. pool-start</h3><p>Via following command you could view and start the virsh pool:</p><pre><code>$ sudo virsh pool-list --all
$ sudo virsh pool-start vagrantpool
</code></pre><h3 id=55-minikube-start-specify-cpumemdisk>55. minikube start specify cpu/mem/disk</h3><p>via following method:</p><pre><code># minikube start --cpus 4 --memory 8192 --disk-size 60g
</code></pre><h3 id=56-combine-lines-under-linux>56. Combine lines under linux</h3><p>Via tr command you could combine several lines into one line:</p><pre><code># some output | tr '\n' ','
</code></pre><p>Replace the comma with some other characters.</p><h3 id=57-prometheus-for-k8s>57. prometheus for k8s</h3><p>URL:</p><p>from <a href=https://github.com/coreos/prometheus-operator/tree/master/contrib/kube-prometheus>https://github.com/coreos/prometheus-operator/tree/master/contrib/kube-prometheus</a></p><h3 id=58-virtualbox-tips>58. virtualbox tips</h3><p>Debian&rsquo;s virtualbox, 5.2 conflicts with kernel 4.17.0-9.bpo.1-amd64</p><h3 id=59-libvirts-bus-issue>59. libvirt&rsquo;s bus issue</h3><p>Changes to virtio bus:</p><pre><code>            lv.storage :file, :device =&gt; &quot;hd#{driverletters[d]}&quot;, :path =&gt; &quot;glusterdisk-#{i}-#{d}-#{DISK_UUID}.disk&quot;, :size =&gt; $kube_node_instances_with_disks_size, :bus =&gt; &quot;virtio&quot;

</code></pre><h3 id=60-minimum-glusterfs-nodes>60. Minimum glusterfs nodes</h3><p>Comment the replcas items. and set the volume type to None:</p><pre><code>  volumetype: &quot;none&quot;
#  volumetype: &quot;replicate:{{ hostvars[groups['glusterfs'][0]].replicate }}&quot;

</code></pre><p>Or using heketi for creating the volume:</p><pre><code>heketi-cli volume create -size=100 -durabilty=none
</code></pre><h3 id=61-history-without-number>61. history without number</h3><p>history without number using cut.</p><pre><code> history | cut -c 8-
</code></pre><h3 id=62-tr-replace-newline>62. tr replace newline</h3><p>Via following commands:</p><pre><code>#  tr '\r\n' ' '
</code></pre><h3 id=63-two-file-difference>63. two file difference</h3><p>via grep command you could do this:</p><pre><code># git -v -f before.txt after.txt
</code></pre><h3 id=64-vimdiff-tips>64. vimdiff tips</h3><p>vimdiff tips.</p><pre><code>
do (diff obtain) and dp (diff put) is what you need. Here is a small list of other helpful normal mode commands in this context.

]c               - advance to the next block with differences
[c               - reverse search for the previous block with differences
do (diff obtain) - bring changes from the other file to the current file
dp (diff put)    - send changes from the current file to the other file
zo               - unfold/unhide text
zc               - refold/rehide text
zr               - unfold both files completely
zm               - fold both files completely
</code></pre><h3 id=65-pactree>65. pactree</h3><p>Using pactree for viewing the dependencies:</p><pre><code># sudo pacman -S pacman-contri
# pactree xxxx
</code></pre><p>Using -d(1~n) could viewing the depth of the dependencies.</p><h3 id=66-wifi-list>66. wifi list</h3><p>unblock the wifi via following commands:</p><pre><code>$rfkill list all
0: hp-wifi: Wireless LAN
	Soft blocked: yes
	Hard blocked: no
1: phy0: Wireless LAN
	Soft blocked: yes
	Hard blocked: yes

$sudo rfkill unblock all
</code></pre><h3 id=67-sed-disable-swap>67. sed disable swap</h3><p>edit /etc/fstab via:</p><pre><code># sudo sed -i '/ swap / s/^/#/' /etc/fstab

</code></pre><h3 id=68-python-split>68. python split</h3><p>For using them in ambari-k8s, do following:</p><pre><code>&gt;&gt;&gt; long='nodes-1:10.222.129.101;nodes-2:10.222.129.102;nodes-3:10.222.129.103'
&gt;&gt;&gt; map={}
&gt;&gt;&gt; key=[]
&gt;&gt;&gt; for i in long.split(&quot;;&quot;):
...   key.append(i.split(&quot;:&quot;)[0])
...   map[i.split(&quot;:&quot;)[0]]=i.split(&quot;:&quot;)[1]
... 
&gt;&gt;&gt; for i in key:
...   print(i)
... 
nodes-1
nodes-2
nodes-3
&gt;&gt;&gt; for i in key:
...   print(i)
...   print(map[i])
... 
nodes-1
10.222.129.101
nodes-2
10.222.129.102
nodes-3
10.222.129.103

</code></pre><h3 id=69-proxmox-configuration>69. proxmox Configuration</h3><p>For AI project, do following:</p><pre><code># vim /etc/network/interfaces
auto lo
iface lo inet loopback

auto eno1
#real IP address
iface eno1 inet static
        address  198.51.100.5
        netmask  255.255.255.0
        gateway  198.51.100.1

auto vmbr0
#private sub network
iface vmbr0 inet static
        address  10.10.10.1
        netmask  255.255.255.0
        bridge_ports none
        bridge_stp off
        bridge_fd 0

        post-up echo 1 &gt; /proc/sys/net/ipv4/ip_forward
        post-up   iptables -t nat -A POSTROUTING -s '10.10.10.0/24' -o eno1 -j MASQUERADE
        post-down iptables -t nat -D POSTROUTING -s '10.10.10.0/24' -o eno1 -j MASQUERADE
</code></pre><p>ZFS enabled when in installation.</p><h3 id=70-proxmox-inner-network>70. proxmox inner network</h3><p>Connecting inner network via:</p><pre><code>post-up iptables -t nat -A POSTROUTING -s 10.10.10.0/24 -o enp2s0f0 -j SNAT
--to-source 192.192.18.44
</code></pre><p>In every nodes:</p><pre><code>$ route add -net 10.10.10.0/24 gw 192.192.189.44
</code></pre><h3 id=71-vagrant-libvirt>71. vagrant-libvirt</h3><p>Remove the vagrant-libvirt package installed via yaourt, then install plugin
via:</p><pre><code># vagrant plugin install vagrant-libvirt
</code></pre><p>You won&rsquo;t have the build issue.</p><h3 id=72-beyond-compare-linux>72. beyond compare Linux</h3><p>Reuse it after 30 day&rsquo;s trial:</p><pre><code>bcompare在ubuntu的配置文件的路径是：

/home/xxx/.config/bcompare

在该路径下找到 registry.dat删除即可

rm registry.dat
</code></pre><h3 id=73-forwarding-in-win>73. forwarding in Win</h3><p>Use following command for setting up tunnel under windows:</p><pre><code>netsh interface portproxy add v4tov4 listenport=4422 listenaddress=192.168.1.111 connectport=80 connectaddress=192.168.0.33
To remove forwarding:
netsh interface portproxy delete v4tov4 listenport=4422 listenaddress=192.168.1.111
</code></pre></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>