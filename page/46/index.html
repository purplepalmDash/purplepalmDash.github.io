<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta name=generator content="Hugo 0.64.0"><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Dash &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><link href=%7balternate%20%7bRSS%20application/rss+xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/index.xml%20http://purplepalmdash.github.io/index.xml%7d rel=alternate type=application/rss+xml title="Dash &#183; Dash"><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>很惭愧，就做了一点微小的工作</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=posts><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/10/16/kubeovnworkingtips/>KubeOVNWorkingTips</a></h1><span class=post-date>Oct 16, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=server-sidek8s>Server side(k8s)</h3><p><code>kkk.yaml</code> defined the subnet created via kubeovn</p><pre><code>apiVersion: kubeovn.io/v1
kind: Subnet
metadata:
  name: etc
spec:
  protocol: IPv4
  default: false
  namespaces:
  - etl
  - etl1
  cidrBlock: 100.64.0.0/16
  gateway: 100.64.0.1
  excludeIps:
  - 100.64.0.1
  private: false
  gatewayType: distributed
  natOutgoing: false
</code></pre><p>Create the subnet via <code>kubectl create -f kkk.yaml</code>, then you could view the subnet via:</p><pre><code># kubectl get subnet
NAME	PROTOCOL	CIDR		PRIVATE	NAT	DEFAULT	GATEWAYTYPE	USED AVAILABLE
etc	IPV4		100.64.0.0/16	false	false	false	distributed	1	65532
</code></pre><p>Create namespace via <code>kubectl create ns etl</code> and <code>kubectl create ns etl1</code>, then run a deployment in these 2 namespace:</p><pre><code># kubectl run nginxetl --image=nginx:1.17 --namespace etl
# kubectl get pod -n etl -o wide
The pod's ip address is 100.64.0.3
</code></pre><h3 id=client-sideouter-space-machines>Client Side(outer space machines)</h3><p>Add route via:</p><pre><code># route add -net 100.64.0.0/16 gw 192.192.xxx.xxx
# curl 100.64.0.3
</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/28/openwrtbox/>OpenWRTBox</a></h1><span class=post-date>Sep 28, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=tips>Tips</h3><p>Version: <code>ATTITUDE ADJUSTMENT (12.09, r36088)</code>, so we have to login into this box via:</p><pre><code>$ ssh -oKexAlgorithms=+diffie-hellman-group1-sha1  root@192.168.2.1
</code></pre><p>Luckly we got the dhcp enabled in this equipment!!! Otherwise this equipment is bricked.</p><p>Change wifi setting under <code>Network->Wifi->Interface Configuration->General Setup</code>:</p><p><img src=/images/2020_09_28_09_49_31_986x277.jpg alt=/images/2020_09_28_09_49_31_986x277.jpg></p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/27/etcdrecovery/>etcdRecovery</a></h1><span class=post-date>Sep 27, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>主节点操作:</p><pre><code>root@newnode-1:/home/test# ETCDCTL_API=3 etcdctl --endpoints=https://192.168.122.21:2379 --cacert=&quot;/etc/ssl/etcd/ssl/ca.pem&quot; --cert=&quot;/etc/ssl/etcd/ssl/member-newnode-1.pem&quot; --key=&quot;/etc/ssl/etcd/ssl/member-newnode-1-key.pem&quot; member list
4047613ce64ac480, started, etcd2, https://192.168.122.58:2380, https://192.168.122.58:2379
ac76e9faf75cf70f, started, etcd3, https://192.168.122.75:2380, https://192.168.122.75:2379
e99611c964d08e01, started, etcd1, https://192.168.122.21:2380, https://192.168.122.21:2379
root@newnode-1:/home/test# ETCDCTL_API=2 etcdctl --endpoints=https://192.168.122.21:2379 --ca-file=&quot;/etc/ssl/etcd/ssl/ca.pem&quot; --cert-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1.pem&quot; --key-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1-key.pem&quot; cluster-health
member 4047613ce64ac480 is healthy: got healthy result from https://192.168.122.58:2379
failed to check the health of member ac76e9faf75cf70f on https://192.168.122.75:2379: Get https://192.168.122.75:2379/health: dial tcp 192.168.122.75:2379: connect: connection refused
member ac76e9faf75cf70f is unreachable: [https://192.168.122.75:2379] are all unreachable
member e99611c964d08e01 is healthy: got healthy result from https://192.168.122.21:2379
cluster is degraded
</code></pre><p>删除问题节点:</p><pre><code>root@newnode-1:/home/test# ETCDCTL_API=2 etcdctl --endpoints=https://192.168.122.21:2379 --ca-file=&quot;/etc/ssl/etcd/ssl/ca.pem&quot; --cert-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1.pem&quot; --key-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1-key.pem&quot; member remove ac76e9faf75cf70f
Removed member ac76e9faf75cf70f from cluster
root@newnode-1:/home/test# ETCDCTL_API=2 etcdctl --endpoints=https://192.168.122.21:2379 --ca-file=&quot;/etc/ssl/etcd/ssl/ca.pem&quot; --cert-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1.pem&quot; --key-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1-key.pem&quot; member list
4047613ce64ac480: name=etcd2 peerURLs=https://192.168.122.58:2380 clientURLs=https://192.168.122.58:2379 isLeader=true
e99611c964d08e01: name=etcd1 peerURLs=https://192.168.122.21:2380 clientURLs=https://192.168.122.21:2379 isLeader=false
</code></pre><p>问题节点上操作:</p><pre><code>systemctl stop etcd
mv /var/lib/etcd /var/lib/etcd.back
mkdir /var/lib/etcd
systemctl start etcd
</code></pre><p>新增:</p><pre><code>root@newnode-1:/home/test# ETCDCTL_API=2 etcdctl --endpoints=https://192.168.122.21:2379 --ca-file=&quot;/etc/ssl/etcd/ssl/ca.pem&quot; --cert-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1.pem&quot; --key-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1-key.pem&quot; member add etcd3 https://192.168.122.75:2380
Added member named etcd3 with ID 318e07d1cc0d3933 to cluster

ETCD_NAME=&quot;etcd3&quot;
ETCD_INITIAL_CLUSTER=&quot;etcd3=https://192.168.122.75:2380,etcd2=https://192.168.122.58:2380,etcd1=https://192.168.122.21:2380&quot;
ETCD_INITIAL_CLUSTER_STATE=&quot;existing&quot;
root@newnode-1:/home/test# ETCDCTL_API=2 etcdctl --endpoints=https://192.168.122.21:2379 --ca-file=&quot;/etc/ssl/etcd/ssl/ca.pem&quot; --cert-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1.pem&quot; --key-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1-key.pem&quot; member list
318e07d1cc0d3933[unstarted]: peerURLs=https://192.168.122.75:2380
4047613ce64ac480: name=etcd2 peerURLs=https://192.168.122.58:2380 clientURLs=https://192.168.122.58:2379 isLeader=true
e99611c964d08e01: name=etcd1 peerURLs=https://192.168.122.21:2380 clientURLs=https://192.168.122.21:2379 isLeader=false
</code></pre><p>如果是unstarted 状态，则到有问题节点:</p><pre><code>systemctl stop etcd
rm -rf /var/lib/etcd/member
systemctl start etcd
</code></pre><p>回到主节点， 观察集群状态是否回复成功</p><pre><code>root@newnode-1:/home/test# ETCDCTL_API=2 etcdctl --endpoints=https://192.168.122.21:2379 --ca-file=&quot;/etc/ssl/etcd/ssl/ca.pem&quot; --cert-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1.pem&quot; --key-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1-key.pem&quot; member list
4047613ce64ac480: name=etcd2 peerURLs=https://192.168.122.58:2380 clientURLs=https://192.168.122.58:2379 isLeader=true
531c8ba1dbabce70: name=etcd3 peerURLs=https://192.168.122.75:2380 clientURLs=https://192.168.122.75:2379 isLeader=false
e99611c964d08e01: name=etcd1 peerURLs=https://192.168.122.21:2380 clientURLs=https://192.168.122.21:2379 isLeader=false
root@newnode-1:/home/test# ETCDCTL_API=2 etcdctl --endpoints=https://192.168.122.21:2379 --ca-file=&quot;/etc/ssl/etcd/ssl/ca.pem&quot; --cert-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1.pem&quot; --key-file=&quot;/etc/ssl/etcd/ssl/member-newnode-1-key.pem&quot; cluster-health
member 4047613ce64ac480 is healthy: got healthy result from https://192.168.122.58:2379
member 531c8ba1dbabce70 is healthy: got healthy result from https://192.168.122.75:2379
member e99611c964d08e01 is healthy: got healthy result from https://192.168.122.21:2379
cluster is healthy
</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/27/joggleropenframe/>JogglerOpenFrame</a></h1><span class=post-date>Sep 27, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=reflash-latest-firmware>Reflash latest firmware</h3><p>Examine the disk and write the image to disk:</p><pre><code>Disk /dev/sdd：1.88 GiB，2021654528 字节，3948544 个扇区
磁盘型号：                
单元：扇区 / 1 * 512 = 512 字节
扇区大小(逻辑/物理)：512 字节 / 512 字节
I/O 大小(最小/最佳)：512 字节 / 512 字节
磁盘标签类型：dos
磁盘标识符：0x2fbbe9fe

设备       启动 起点    末尾    扇区  大小 Id 类型
/dev/sdd1  *       0 1390591 1390592  679M  0 空
/dev/sdd2        264  131335  131072   64M ef EFI (FAT-12/16/32)
dash@archnvme:/media/sda $ cd ~/Downloads 
dash@archnvme:~/Downloads $ sudo su   
[root@archnvme Downloads]# gzip -dc reflash111_of.img.gz | dd of=/dev/sdd bs=1M
</code></pre><p>Mount reflash&rsquo;s usb disk into computer:</p><pre><code>Mount the USB device on your system; you should see a volume named rfl-boot.
On the rfl-boot volume there is a directory named reflash.
Download the operating system image you would like to write, along with its MD5 file.
Copy both the compressed .img.gz file and its .img.gz.md5 counterpart into the reflash directory.
</code></pre><p>Now insert the flashed usb disk into joggler, then flash will begin.</p><p>After flashing, could poweron from flash.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/24/visualstudiocodemarkdownwriting/>VisualStudioCodeMarkdownWriting</a></h1><span class=post-date>Sep 24, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=installation>Installation</h3><p>Install microsoft visual studio code via:</p><pre><code>$ sudo vim /etc/pacman.conf
[archlinuxcn]
#The Chinese Arch Linux communities packages.
SigLevel = Never
Server   = http://repo.archlinuxcn.org/$arch
$ sudo pacman -Sy
$ sudo pacman -S visual-studio-code-bin
</code></pre><h3 id=install-plugin>Install Plugin</h3><p>Install via:</p><p><img src=/images/2020_09_24_09_58_02_326x285.jpg alt=/images/2020_09_24_09_58_02_326x285.jpg></p><p>Install prince(for converting to pdf)via:</p><pre><code>$ sudo pacman -S prince-bin
</code></pre><p>Configure the stylesheet for prince&rsquo;s generated output:</p><pre><code>$ cat ~/.mume/style.less
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */ 

.markdown-preview.markdown-preview {
  // modify your style here
  // eg: background-color: blue;  
  &amp;.prince {
    @page {
      //size: A4 landscape
      size: A4 PortraitModes
    }
    @font-face {
      font-family: sans-serif;
      font-style: normal;
      font-weight: normal;
      src: url(&quot;/usr/share/fonts/adobe-source-han-sans/SourceHanSansCN-Regular.otf&quot;)
  }

  @font-face {
      font-family: sans-serif;
      font-style: normal;
      font-weight: bold;
      src: url(&quot;/usr/share/fonts/adobe-source-han-sans/SourceHanSansCN-Bold.otf&quot;)
  }

  @font-face {
      font-family: sans-serif;
      font-style: italic;
      font-weight: normal;
      src: url(&quot;/usr/share/fonts/adobe-source-code-pro/SourceCodePro-It.otf&quot;)
      //src: url(&quot;/usr/share/fonts/adobe-source-han-sans/SourceHanSansCN-Regular.otf&quot;)
  }

  @font-face {
      font-family: sans-serif;
      font-style: italic;
      font-weight: bold;
      src: url(&quot;/usr/share/fonts/adobe-source-code-pro/SourceCodePro-BoldIt.otf&quot;)
      //src: url(&quot;/usr/share/fonts/adobe-source-han-sans/SourceHanSansCN-Bold.otf&quot;)
  }
  }
}
</code></pre><p>Or edit the css via <code>ctrl+shift+p</code> and Run <code>Markdown Preview Enhanced: Customize Css</code>, Insert the above code.</p></div><ul class=pagination><li class=page-item><a href=/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/page/45/ class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/>1</a></li><li class=page-item><a class=page-link href=/page/2/>2</a></li><li class=page-item><a class=page-link href=/page/3/>3</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/45/>45</a></li><li class="page-item active"><a class=page-link href=/page/46/>46</a></li><li class=page-item><a class=page-link href=/page/47/>47</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/242/>242</a></li><li class=page-item><a href=/page/47/ class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/242/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>