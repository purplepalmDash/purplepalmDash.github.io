<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta name=generator content="Hugo 0.64.0"><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Dash &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><link href=%7balternate%20%7bRSS%20application/rss+xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/index.xml%20http://purplepalmdash.github.io/index.xml%7d rel=alternate type=application/rss+xml title="Dash &#183; Dash"><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>很惭愧，就做了一点微小的工作</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=posts><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/02/03/workingtipsoncellsandroid10cn/>WorkingTipsONCellsAndroid10CN</a></h1><span class=post-date>Feb 3, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=1-cells源码准备>1. cells源码准备</h3><p>从github克隆代码至本地目录</p><pre><code># mkdir -p ~/Code/show/cells
# cd ~/Code/show/cells
# git clone https://github.com/jianglin-code/cells-android10.git
# cd cells-android10
# ls
cells  frameworks  kernel  README.md  system
</code></pre><h3 id=2-aosp-10源码准备>2. aosp 10源码准备</h3><p>对标cells源码中的要求, 克隆特定版本的aosp10源码(<code>10.0.0_r33</code>):</p><pre><code># mkdir -p ~/Code/show/aosp10
# cd ~/Code/show/aosp10
# repo init -u https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest -b android-10.0.0_r33
# repo sync -j8
</code></pre><h3 id=3-内核源码准备>3. 内核源码准备</h3><p>因为使用的真机是pixel 3a，内核源码的获取见以下代码:</p><pre><code># mkdir -p ~/Code/show/android-kernel
# cd ~/Code/show/android-kernel
#  repo init --depth 1 -u https://aosp.tuna.tsinghua.edu.cn/kernel/manifest -b android-msm-bonito-4.9-android10
# repo sync -j4
# ls
build  build.config  prebuilts  prebuilts-master  private
# du -hs *
732K	build
0	build.config
189M	prebuilts
5.8G	prebuilts-master
870M	private
</code></pre><h3 id=4-二进制驱动准备>4. 二进制驱动准备</h3><p>从以下网址查找真机对应需要的二进制驱动标号:<br><code>https://source.android.com/setup/start/build-numbers#source-code-tags-and-builds</code>:</p><pre><code>QQ2A.200305.002	android-10.0.0_r30	Android10	Pixel 2、Pixel 2 XL、Pixel 3、Pixel 3 XL、Pixel 3a、Pixel 3a XL	2020-03-05
</code></pre><p>根据查找出的代号，从以下网址下载二进制驱动文件:<br><code>https://developers.google.cn/android/drivers?hl=zh-cn#sargoqq2a.200405.005</code>:</p><p><img src=/images/2022_02_02_22_55_30_880x211.jpg alt=/images/2022_02_02_22_55_30_880x211.jpg></p><p>将下载的二进制驱动文件拷贝到aosp源码树:</p><pre><code># cp extract-google_devices-sargo.sh extract-qcom-sargo.sh /root/Code/show/aosp10
</code></pre><h3 id=5-编译内核>5. 编译内核</h3><p>使用<code>cells</code>源码中的相应目录替换aosp10内核中对应代码:</p><pre><code># mv private/msm-google private/msm-google.back
# cp -ar  ~/Code/show/cells/cells-android10/kernel/ private/msm-google
</code></pre><p>使用以下命令编译内核:</p><pre><code># cd private/msm-google
# make mrproper
# cd ../../
# cp -r private/msm-google.back/techpack/ private/msm-google/
# vim build/build.sh
comment the line of soong_zip(line 798)
# build/build.sh
</code></pre><p>检验内核编译出的二进制文件:</p><pre><code># ls out/android-msm-pixel-4.9/dist/
abi.prop  Image.lz4              kernel-uapi-headers.tar.gz  System.map  wlan.ko
dtbo.img  kernel-headers.tar.gz  sdm670.dtb                  vmlinux
</code></pre><h3 id=6-aosp源码编译>6. aosp源码编译</h3><p>解压二进制驱动代码:</p><pre><code># ./extract-google_devices-sargo.sh 
# ./extract-qcom-sargo.sh 
</code></pre><p>替换aosp中内置的内核代码:</p><pre><code># mv device/google/bonito-kernel/Image.lz4 device/google/bonito-kernel/Image.lz4.back
# cp /root/Code/show/android-kernel/out/android-msm-pixel-4.9/dist/Image.lz4 device/google/bonito-kernel/Image.lz4
</code></pre><p>将cells源码并入到aosp编译树中:</p><pre><code># cp -r /root/Code/show/cells/cells-android10/cells/ vendor/
# vim device/google/bonito/device.mk
Added at the last line:   
$(call inherit-product-if-exists, vendor/cells/cells_build.mk)
</code></pre><p>开始编译:</p><pre><code># source build/envsetup.sh
# lunch aosp_sargo-userdebug
# vim frameworks/base/data/etc/privapp-permissions-platform.xml
增加: 
    &lt;privapp-permissions package=&quot;com.cells.cellswitch.secure&quot;&gt;
        &lt;permission name=&quot;android.permission.BLUETOOTH_PRIVILEGED&quot;/&gt;
    &lt;/privapp-permissions&gt;
# vim vendor/cells/switchsystem/src/com/cells/cellswitch/secure/view/SwitchActivity.java
注释掉: 
//import android.os.CellsManager;
//import android.os.ICellsManager;
# cp -r /root/Code/show/aosp10back/frameworks/multidex/library/
frameworks/multidex
# m -j128
</code></pre><p>编译到80%左右时将失败，重新计算依赖后编译方可成功:</p><pre><code># development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libbinder &amp;&amp; development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libhwbinder_noltopgo &amp;&amp; development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libhidlbase &amp;&amp; m -j128
</code></pre><p>检验编译输出文件:</p><pre><code># ls out/target/product/sargo/*.img
out/target/product/sargo/boot-debug.img     out/target/product/sargo/ramdisk.img
out/target/product/sargo/boot.img           out/target/product/sargo/ramdisk-recovery.img
out/target/product/sargo/dtb.img            out/target/product/sargo/super_empty.img
out/target/product/sargo/dtbo.img           out/target/product/sargo/system.img
out/target/product/sargo/persist.img        out/target/product/sargo/system_other.img
out/target/product/sargo/product.img        out/target/product/sargo/vbmeta.img
out/target/product/sargo/ramdisk-debug.img  out/target/product/sargo/vendor.img
</code></pre><p>最终编译树尺寸大小:</p><pre><code># du -hs *
15G     android-kernel
177G    aosp10
2.4G    aosp10back
6.0G    cells
</code></pre><h3 id=7-烧写镜像>7. 烧写镜像</h3><p>通过USB连接pixel 3a:</p><pre><code>$ adb devices
List of devices attached
92UAY04L95	device

$  adb reboot bootloader
</code></pre><p>通过以下命令烧录镜像:</p><pre><code>$ fastboot devices
92UAY04L95	fastboot
$ export ANDROID_PRODUCT_OUT=/root/Code/show/aosp10/out/target/product/sargo
$ fastboot flashall -w
--------------------------------------------
Bootloader Version...: b4s4-0.2-6355063
Baseband Version.....: g670-00042-200421-B-6414611
Serial Number........: 92UAY04L95
--------------------------------------------
Checking 'product'                                 OKAY [  0.058s]
Setting current slot to 'b'                        OKAY [  0.138s]
.....
Erasing 'userdata'                                 OKAY [  0.311s]
Erase successful, but not automatically formatting.
File system type raw not supported.
Erasing 'metadata'                                 OKAY [  0.006s]
Erase successful, but not automatically formatting.
File system type raw not supported.
Rebooting                                          OKAY [  0.001s]
Finished. Total time: 336.662s
</code></pre><p>将二进制驱动烧录进真机，从而可以使用无线连接:</p><pre><code># 禁用校验机制
adb root
adb disable-verity
adb shell sync
adb reboot

# 上传模块
adb root
adb remount
adb push /media/nfs1/android-kernel/out/android-msm-pixel-4.9/dist/wlan.ko /vendor/lib/modules/

# 重启手机生效
adb reboot

</code></pre><h3 id=8-基本使用场景>8. 基本使用场景</h3><p>检验编译串号:<br><img src=/images/2022_02_03_10_18_02_498x265.jpg alt=/images/2022_02_03_10_18_02_498x265.jpg></p><p><code>控制中心</code>是用来切换双系统的快捷方式:</p><p><img src=/images/2022_02_03_10_26_40_346x397.jpg alt=/images/2022_02_03_10_26_40_346x397.jpg></p><p>点击<code>控制中心</code>后将出现<code>Start</code>按钮:</p><p><img src=/images/2022_02_03_10_27_56_236x459.jpg alt=/images/2022_02_03_10_27_56_236x459.jpg></p><p>点击<code>Start</code>按钮后，第二系统将启动:</p><p><img src=/images/2022_02_03_10_28_34_234x472.jpg alt=/images/2022_02_03_10_28_34_234x472.jpg></p><p>启动成功:</p><p><img src=/images/2022_02_03_10_29_19_233x477.jpg alt=/images/2022_02_03_10_29_19_233x477.jpg></p><p>再次点击<code>Start</code>按钮进入到第二系统:</p><p><img src=/images/2022_02_03_10_30_12_230x475.jpg alt=/images/2022_02_03_10_30_12_230x475.jpg></p><p>在第二系统中点击<code>控制中心</code>将提示推出该系统并回到主系统:</p><p><img src=/images/2022_02_03_10_31_09_231x479.jpg alt=/images/2022_02_03_10_31_09_231x479.jpg></p><p>退出后将回到第一系统的锁屏界面:</p><p><img src=/images/2022_02_03_10_31_44_235x479.jpg alt=/images/2022_02_03_10_31_44_235x479.jpg></p><h3 id=9-定制化>9. 定制化</h3><p>定制化1： 语言设置/输入法设置</p><p>定制化2：为双系统各自安装软件仓库:</p><pre><code>$ adb install apks/MobileAssistant_1.apk 
Performing Streamed Install
Success
</code></pre><p>定制化3：为双系统安装更多的apks：</p><p>定制化4: 更改主题等</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/02/02/cellsonandroid10integrationcn/>CellsOnAndroid10IntegrationCN</a></h1><span class=post-date>Feb 2, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=1-cells源码准备>1. cells源码准备</h3><p>从github克隆代码至本地目录</p><pre><code># mkdir -p ~/Code/show/cells
# cd ~/Code/show/cells
# git clone https://github.com/jianglin-code/cells-android10.git
# cd cells-android10
# ls
cells  frameworks  kernel  README.md  system
</code></pre><h3 id=2-aosp-10源码准备>2. aosp 10源码准备</h3><p>对标cells源码中的要求, 克隆特定版本的aosp10源码(<code>10.0.0_r33</code>):</p><pre><code># mkdir -p ~/Code/show/aosp10
# cd ~/Code/show/aosp10
# repo init -u https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest -b android-10.0.0_r33
# repo sync -j8
</code></pre><h3 id=3-内核源码准备>3. 内核源码准备</h3><p>因为使用的真机是pixel 3a，内核源码的获取见以下代码:</p><pre><code># mkdir -p ~/Code/show/android-kernel
# cd ~/Code/show/android-kernel
#  repo init --depth 1 -u https://aosp.tuna.tsinghua.edu.cn/kernel/manifest -b android-msm-bonito-4.9-android10
# repo sync -j4
# ls
build  build.config  prebuilts  prebuilts-master  private
# du -hs *
732K	build
0	build.config
189M	prebuilts
5.8G	prebuilts-master
870M	private
</code></pre><h3 id=4-二进制驱动准备>4. 二进制驱动准备</h3><p>从以下网址查找真机对应需要的二进制驱动标号:<br><code>https://source.android.com/setup/start/build-numbers#source-code-tags-and-builds</code>:</p><pre><code>QQ2A.200305.002	android-10.0.0_r30	Android10	Pixel 2、Pixel 2 XL、Pixel 3、Pixel 3 XL、Pixel 3a、Pixel 3a XL	2020-03-05
</code></pre><p>根据查找出的代号，从以下网址下载二进制驱动文件:<br><code>https://developers.google.cn/android/drivers?hl=zh-cn#sargoqq2a.200405.005</code>:</p><p><img src=/images/2022_02_02_22_55_30_880x211.jpg alt=/images/2022_02_02_22_55_30_880x211.jpg></p><p>将下载的二进制驱动文件拷贝到aosp源码树:</p><pre><code># cp extract-google_devices-sargo.sh extract-qcom-sargo.sh /root/Code/show/aosp10
</code></pre><h3 id=5-编译内核>5. 编译内核</h3><p>使用<code>cells</code>源码中的相应目录替换aosp10内核中对应代码:</p><pre><code># mv private/msm-google private/msm-google.back
# cp -ar  ~/Code/show/cells/cells-android10/kernel/ private/msm-google
</code></pre><p>使用以下命令编译内核:</p><pre><code># cd private/msm-google
# make mrproper
# cd ../../
# cp -r private/msm-google.back/techpack/ private/msm-google/
# vim build/build.sh
comment the line of soong_zip(line 798)
# build/build.sh
</code></pre><p>检验内核编译出的二进制文件:</p><pre><code># ls out/android-msm-pixel-4.9/dist/
abi.prop  Image.lz4              kernel-uapi-headers.tar.gz  System.map  wlan.ko
dtbo.img  kernel-headers.tar.gz  sdm670.dtb                  vmlinux
</code></pre><h3 id=6-aosp源码编译>6. aosp源码编译</h3><p>解压二进制驱动代码:</p><pre><code># ./extract-google_devices-sargo.sh 
# ./extract-qcom-sargo.sh 
</code></pre><p>替换aosp中内置的内核代码:</p><pre><code># mv device/google/bonito-kernel/Image.lz4 device/google/bonito-kernel/Image.lz4.back
# cp /root/Code/show/android-kernel/out/android-msm-pixel-4.9/dist/Image.lz4 device/google/bonito-kernel/Image.lz4
</code></pre><p>将cells源码并入到aosp编译树中:</p><pre><code># cp -r /root/Code/show/cells/cells-android10/cells/ vendor/
# vim device/google/bonito/device.mk
Added at the last line:   
$(call inherit-product-if-exists, vendor/cells/cells_build.mk)
</code></pre><p>开始编译:</p><pre><code># source build/envsetup.sh
# lunch aosp_sargo-userdebug
# vim frameworks/base/data/etc/privapp-permissions-platform.xml
增加: 
    &lt;privapp-permissions package=&quot;com.cells.cellswitch.secure&quot;&gt;
        &lt;permission name=&quot;android.permission.BLUETOOTH_PRIVILEGED&quot;/&gt;
    &lt;/privapp-permissions&gt;
# vim vendor/cells/switchsystem/src/com/cells/cellswitch/secure/view/SwitchActivity.java
注释掉: 
//import android.os.CellsManager;
//import android.os.ICellsManager;
# cp -r /root/Code/show/aosp10back/frameworks/multidex/library/
frameworks/multidex
# m -j128
</code></pre><p>编译到80%左右时将失败，重新计算依赖后编译方可成功:</p><pre><code># development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libbinder &amp;&amp; development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libhwbinder_noltopgo &amp;&amp; development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libhidlbase &amp;&amp; m -j128
</code></pre><p>检验编译输出文件:</p><pre><code># ls out/target/product/sargo/*.img
out/target/product/sargo/boot-debug.img     out/target/product/sargo/ramdisk.img
out/target/product/sargo/boot.img           out/target/product/sargo/ramdisk-recovery.img
out/target/product/sargo/dtb.img            out/target/product/sargo/super_empty.img
out/target/product/sargo/dtbo.img           out/target/product/sargo/system.img
out/target/product/sargo/persist.img        out/target/product/sargo/system_other.img
out/target/product/sargo/product.img        out/target/product/sargo/vbmeta.img
out/target/product/sargo/ramdisk-debug.img  out/target/product/sargo/vendor.img
</code></pre><p>最终编译树尺寸大小:</p><pre><code># du -hs *
15G     android-kernel
177G    aosp10
2.4G    aosp10back
6.0G    cells
</code></pre><h3 id=7-烧写镜像>7. 烧写镜像</h3><p>通过USB连接pixel 3a:</p><pre><code>$ adb devices
List of devices attached
92UAY04L95	device

$  adb reboot bootloader
</code></pre><p>通过以下命令烧录镜像:</p><pre><code>$ fastboot devices
92UAY04L95	fastboot
$ export ANDROID_PRODUCT_OUT=/root/Code/show/aosp10/out/target/product/sargo
$ fastboot flashall -w
--------------------------------------------
Bootloader Version...: b4s4-0.2-6355063
Baseband Version.....: g670-00042-200421-B-6414611
Serial Number........: 92UAY04L95
--------------------------------------------
Checking 'product'                                 OKAY [  0.058s]
Setting current slot to 'b'                        OKAY [  0.138s]
.....
Erasing 'userdata'                                 OKAY [  0.311s]
Erase successful, but not automatically formatting.
File system type raw not supported.
Erasing 'metadata'                                 OKAY [  0.006s]
Erase successful, but not automatically formatting.
File system type raw not supported.
Rebooting                                          OKAY [  0.001s]
Finished. Total time: 336.662s
</code></pre><p>将二进制驱动烧录进真机，从而可以使用无线连接:</p><pre><code># 禁用校验机制
adb root
adb disable-verity
adb shell sync
adb reboot

# 上传模块
adb root
adb remount
adb push /media/nfs1/android-kernel/out/android-msm-pixel-4.9/dist/wlan.ko /vendor/lib/modules/

# 重启手机生效
adb reboot

</code></pre><h3 id=8-基本使用场景>8. 基本使用场景</h3><p>检验编译串号:<br><img src=/images/2022_02_03_10_18_02_498x265.jpg alt=/images/2022_02_03_10_18_02_498x265.jpg></p><p><code>控制中心</code>是用来切换双系统的快捷方式:</p><p><img src=/images/2022_02_03_10_26_40_346x397.jpg alt=/images/2022_02_03_10_26_40_346x397.jpg></p><p>点击<code>控制中心</code>后将出现<code>Start</code>按钮:</p><p><img src=/images/2022_02_03_10_27_56_236x459.jpg alt=/images/2022_02_03_10_27_56_236x459.jpg></p><p>点击<code>Start</code>按钮后，第二系统将启动:</p><p><img src=/images/2022_02_03_10_28_34_234x472.jpg alt=/images/2022_02_03_10_28_34_234x472.jpg></p><p>启动成功:</p><p><img src=/images/2022_02_03_10_29_19_233x477.jpg alt=/images/2022_02_03_10_29_19_233x477.jpg></p><p>再次点击<code>Start</code>按钮进入到第二系统:</p><p><img src=/images/2022_02_03_10_30_12_230x475.jpg alt=/images/2022_02_03_10_30_12_230x475.jpg></p><p>在第二系统中点击<code>控制中心</code>将提示推出该系统并回到主系统:</p><p><img src=/images/2022_02_03_10_31_09_231x479.jpg alt=/images/2022_02_03_10_31_09_231x479.jpg></p><p>退出后将回到第一系统的锁屏界面:</p><p><img src=/images/2022_02_03_10_31_44_235x479.jpg alt=/images/2022_02_03_10_31_44_235x479.jpg></p><h3 id=9-定制化>9. 定制化</h3><p>定制化1： 语言设置/输入法设置</p><p>定制化2：为双系统各自安装软件仓库:</p><pre><code>$ adb install apks/MobileAssistant_1.apk 
Performing Streamed Install
Success
</code></pre><p>定制化3：为双系统安装更多的apks：</p><p>定制化4: 更改主题等</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/02/02/workingtipsoncellsonandroid10/>WorkingTipsOnCellsOnAndroid10</a></h1><span class=post-date>Feb 2, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=1-cells-src-preparation>1. cells src preparation</h3><p>Clone the cells source code via:</p><pre><code># mkdir -p ~/Code/show/cells
# cd ~/Code/show/cells
# git clone https://github.com/jianglin-code/cells-android10.git
# cd cells-android10
# ls
cells  frameworks  kernel  README.md  system
</code></pre><h3 id=2-aosp-10-src-preparation>2. aosp 10 src preparation</h3><p>Clone the specified aosp 10 version(<code>10.0.0_r33</code>):</p><pre><code># mkdir -p ~/Code/show/aosp10
# cd ~/Code/show/aosp10
# repo init -u https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest -b android-10.0.0_r33
# repo sync -j8
</code></pre><h3 id=3-kernel-src-preparation>3. Kernel src preparation</h3><p>For pixel 3a, clone the kernel src via:</p><pre><code># mkdir -p ~/Code/show/android-kernel
# cd ~/Code/show/android-kernel
#  repo init --depth 1 -u https://aosp.tuna.tsinghua.edu.cn/kernel/manifest -b android-msm-bonito-4.9-android10
# repo sync -j4
# ls
build  build.config  prebuilts  prebuilts-master  private
# du -hs *
732K	build
0	build.config
189M	prebuilts
5.8G	prebuilts-master
870M	private
</code></pre><h3 id=4-driver-binary-preparation>4. Driver binary preparation</h3><p>Find the binary version from
<code>https://source.android.com/setup/start/build-numbers#source-code-tags-and-builds</code>:</p><pre><code>QQ2A.200305.002	android-10.0.0_r30	Android10	Pixel 2、Pixel 2 XL、Pixel 3、Pixel 3 XL、Pixel 3a、Pixel 3a XL	2020-03-05
</code></pre><p>Downlod the driver binary from
<code>https://developers.google.cn/android/drivers?hl=zh-cn#sargoqq2a.200405.005</code>:</p><p><img src=/images/2022_02_02_22_55_30_880x211.jpg alt=/images/2022_02_02_22_55_30_880x211.jpg></p><p>Copy the downloaded files to aosp10 src tree:</p><pre><code># cp extract-google_devices-sargo.sh extract-qcom-sargo.sh /root/Code/show/aosp10
</code></pre><h3 id=5-build-kernel>5. Build kernel</h3><p>Replace the source code via:</p><pre><code># mv private/msm-google private/msm-google.back
# cp -ar  ~/Code/show/cells/cells-android10/kernel/ private/msm-google
</code></pre><p>Build the kernel via:</p><pre><code># cd private/msm-google
# make mrproper
# cd ../../
# cp -r private/msm-google.back/techpack/ private/msm-google/
# vim build/build.sh
comment the line of soong_zip(line 798)
# build/build.sh
</code></pre><p>Examine the kernel out files:</p><pre><code># ls out/android-msm-pixel-4.9/dist/
abi.prop  Image.lz4              kernel-uapi-headers.tar.gz  System.map  wlan.ko
dtbo.img  kernel-headers.tar.gz  sdm670.dtb                  vmlinux
</code></pre><h3 id=6-build-the-aosp>6. Build the aosp</h3><p>Extract the binary files:</p><pre><code># ./extract-google_devices-sargo.sh 
# ./extract-qcom-sargo.sh 
</code></pre><p>Replace the kernel:</p><pre><code># mv device/google/bonito-kernel/Image.lz4 device/google/bonito-kernel/Image.lz4.back
# cp /root/Code/show/android-kernel/out/android-msm-pixel-4.9/dist/Image.lz4 device/google/bonito-kernel/Image.lz4
</code></pre><p>Including the cells into building:</p><pre><code># cp -r /root/Code/show/cells/cells-android10/cells/ vendor/
# vim device/google/bonito/device.mk
Added at the last line:   
$(call inherit-product-if-exists, vendor/cells/cells_build.mk)
</code></pre><p>Building via:</p><pre><code># source build/envsetup.sh
# lunch aosp_sargo-userdebug
# vim frameworks/base/data/etc/privapp-permissions-platform.xml
Added: 
    &lt;privapp-permissions package=&quot;com.cells.cellswitch.secure&quot;&gt;
        &lt;permission name=&quot;android.permission.BLUETOOTH_PRIVILEGED&quot;/&gt;
    &lt;/privapp-permissions&gt;
# vim vendor/cells/switchsystem/src/com/cells/cellswitch/secure/view/SwitchActivity.java
Commentd: 
//import android.os.CellsManager;
//import android.os.ICellsManager;
# cp -r /root/Code/show/aosp10back/frameworks/multidex/library/
frameworks/multidex
# m -j128
</code></pre><p>The building will failed, solved via:</p><pre><code># development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libbinder &amp;&amp; development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libhwbinder_noltopgo &amp;&amp; development/vndk/tools/header-checker/utils/create_reference_dumps.py  -l libhidlbase &amp;&amp; m -j128
</code></pre><p>Output:</p><pre><code># ls out/target/product/sargo/*.img
out/target/product/sargo/boot-debug.img     out/target/product/sargo/ramdisk.img
out/target/product/sargo/boot.img           out/target/product/sargo/ramdisk-recovery.img
out/target/product/sargo/dtb.img            out/target/product/sargo/super_empty.img
out/target/product/sargo/dtbo.img           out/target/product/sargo/system.img
out/target/product/sargo/persist.img        out/target/product/sargo/system_other.img
out/target/product/sargo/product.img        out/target/product/sargo/vbmeta.img
out/target/product/sargo/ramdisk-debug.img  out/target/product/sargo/vendor.img
</code></pre><p>Final size for building:</p><pre><code># du -hs *
15G     android-kernel
177G    aosp10
2.4G    aosp10back
6.0G    cells
</code></pre><h3 id=7-flashing>7. Flashing</h3><p>With pixel 3a connected with usb:</p><pre><code>$ adb devices
List of devices attached
92UAY04L95	device

$  adb reboot bootloader
</code></pre><p>Flash with following command:</p><pre><code>$ fastboot devices
92UAY04L95	fastboot
$ export ANDROID_PRODUCT_OUT=/root/Code/show/aosp10/out/target/product/sargo
$ fastboot flashall -w
--------------------------------------------
Bootloader Version...: b4s4-0.2-6355063
Baseband Version.....: g670-00042-200421-B-6414611
Serial Number........: 92UAY04L95
--------------------------------------------
Checking 'product'                                 OKAY [  0.058s]
Setting current slot to 'b'                        OKAY [  0.138s]
.....
Erasing 'userdata'                                 OKAY [  0.311s]
Erase successful, but not automatically formatting.
File system type raw not supported.
Erasing 'metadata'                                 OKAY [  0.006s]
Erase successful, but not automatically formatting.
File system type raw not supported.
Rebooting                                          OKAY [  0.001s]
Finished. Total time: 336.662s
</code></pre><p>Flashing with wlan.ko, so that we could get wireless connection:</p><pre><code># disable-verity on the phone
adb root
adb disable-verity
adb shell sync
adb reboot

# push module
adb root
adb remount
adb push /media/nfs1/android-kernel/out/android-msm-pixel-4.9/dist/wlan.ko /vendor/lib/modules/

# reboot phone
adb reboot

</code></pre><h3 id=8-basic-usage>8. Basic Usage</h3><p>View the build number:<br><img src=/images/2022_02_03_10_18_02_498x265.jpg alt=/images/2022_02_03_10_18_02_498x265.jpg></p><p><code>Control</code> is the switch for dual-system:</p><p><img src=/images/2022_02_03_10_26_40_346x397.jpg alt=/images/2022_02_03_10_26_40_346x397.jpg></p><p>Press <code>Control</code> shows the <code>Start</code> button:</p><p><img src=/images/2022_02_03_10_27_56_236x459.jpg alt=/images/2022_02_03_10_27_56_236x459.jpg></p><p>The second system is starting:</p><p><img src=/images/2022_02_03_10_28_34_234x472.jpg alt=/images/2022_02_03_10_28_34_234x472.jpg></p><p>After started:</p><p><img src=/images/2022_02_03_10_29_19_233x477.jpg alt=/images/2022_02_03_10_29_19_233x477.jpg></p><p>Press <code>Start</code> for entering the 2nd system:</p><p><img src=/images/2022_02_03_10_30_12_230x475.jpg alt=/images/2022_02_03_10_30_12_230x475.jpg></p><p>Press <code>Control</code> will show hints for Exit this system:</p><p><img src=/images/2022_02_03_10_31_09_231x479.jpg alt=/images/2022_02_03_10_31_09_231x479.jpg></p><p>After exit, the system will show on the screen lock:</p><p><img src=/images/2022_02_03_10_31_44_235x479.jpg alt=/images/2022_02_03_10_31_44_235x479.jpg></p><h3 id=9-customization>9. Customization</h3><p>Language setting.</p><p>Install software shop in both system.:</p><pre><code>$ adb install apks/MobileAssistant_1.apk 
Performing Streamed Install
Success
</code></pre><p>Install more apks in both systems.</p><p>Changing the theme.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/01/29/buildaosp10kernel/>BuildAOSP10Kernel</a></h1><span class=post-date>Jan 29, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>为模拟器emulator编译aosp10的内核.</p><h3 id=内核源码获取>内核源码获取</h3><p>需要获取模拟器自身的内核代码，方法是通过<code>adb shell</code>进入到shell下运行<code>uname -a</code>。</p><p>尽量找和默认内核差不多的版本的内核进行编译，否则有可能编译出的内核无法启动系统。这里选择的是<code>4.14.112+</code>.</p><pre><code>$ git clone https://android.googlesource.com/kernel/goldfish.git
$ git checkout -b android-goldfish-4.14-gchips remotes/origin/android-goldfish-4.14-gchips
$ git branch 
* android-goldfish-4.14-gchips
  master
</code></pre><p>获取的内核源码架构如下：</p><pre><code># ls
arch                          build-kernel.sh  CREDITS        firmware  ipc      lib          modules.builtin  README    sound       verity_dev_keys.x509
block                         built-in.o       crypto         fs        Kbuild   MAINTAINERS  modules.order    samples   System.map  virt
build.config.goldfish.arm64   certs            Documentation  include   Kconfig  Makefile     Module.symvers   scripts   tools       vmlinux
build.config.goldfish.x86_64  COPYING          drivers        init      kernel   mm           net              security  usr         vmlinux.o
</code></pre><h3 id=内核编译链获取>内核编译链获取</h3><p>内核编译链在编译好的<code>aosp10</code>源码下，编译方法不再详细讲解。</p><pre><code># ls prebuilts/gcc/linux-x86/x86/x86_64-linux-android-4.9/
bin  COPYING  COPYING3  COPYING3.LIB  COPYING.LIB  COPYING.RUNTIME  lib  libexec  MODULE_LICENSE_GPL  NOTICE  OWNERS  repo.prop  x86_64-linux-android
# ls prebuilts/qemu-kernel/build-kernel.sh
prebuilts/qemu-kernel/build-kernel.sh
</code></pre><h3 id=编译>编译</h3><p><code>android-goldfish-4.14-gchips</code>内核中需要做以下修改以通过编译:</p><pre><code># vim /security/selinux/include/classmap.h
添加:
    #include &lt;linux/socket.h&gt;
# vim scripts/selinux/mdp/mdp.c 
# scripts/selinux/genheaders/genheaders.c
去掉头文件包含的 #include &lt;sys/socket.h&gt;
</code></pre><p>编译配置:</p><pre><code>export PATH=$PATH:/home/xxxxx/Code/aosp10/prebuilts/gcc/linux-x86/x86/x86_64-linux-android-4.9/bin
export ARCH=x86_64
export CROSS_COMPILE=x86_64-linux-android-
export REAL_CROSS_COMPILE=x86_64-linux-android-
</code></pre><p>创建内核定义文件：</p><pre><code># cp arch/x86/configs/x86_64_ranchu_defconfig  arch/x86/configs/x86_64_emu_defconfig
</code></pre><p>编译:</p><pre><code># /home/xxxx/Code/aosp10/prebuilts/qemu-kernel/build-kernel.sh --arch=x86_64
</code></pre><p>最终编译成品:</p><pre><code># cp /tmp/kernel-qemu/x86_64-4.14.112/kernel-qemu  ~/
</code></pre><h3 id=测试内核>测试内核</h3><p>emulator启动的时候显式指定所需的内核:</p><pre><code># emulator -show-kernel -kernel ~/kernel-qemu
</code></pre><p>检测内核的方式同样是通过<code>adb shell</code>进入到命令行界面下查看内核。</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/01/25/runwaydroidubportsonpixel3a/>RunWaydroidUbportsOnPixel3a</a></h1><span class=post-date>Jan 25, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>最近会研究一些安卓虚拟化的知识，这里记录下来在Pixel
3a上刷Ubports后，在Ubports中启用waydroid的过程。</p><h3 id=1-准备工作相关概念>1. 准备工作/相关概念</h3><p>Pixel
3a一支，淘宝很容易买到，注意要买可解锁BootLoader的，价格大概是四五百块，取决于成色。</p><p>选择Pixel
3a是因为它是Ubports官方支持中比较完善的几个之一，官方的设备支持列表如下：<br><a href="https://devices.ubuntu-touch.io/?pk_vid=5294f9f7280f826e164306913156a7ee">https://devices.ubuntu-touch.io/?pk_vid=5294f9f7280f826e164306913156a7ee</a></p><p>当然如果手头有别的可以刷的手机也可以尝试下, Pixel
3a的刷机体验是比较好的。</p><p>Ubports: Ubuntu touch.<br>Waydroid: 以前称为Anbox-Halium，是Anbox 的重建版本，旨在使用比Anbox
更新更流畅的安卓算力体验。</p><h3 id=2-操作指南>2. 操作指南</h3><h4 id=21-刷入安卓9>2.1 刷入安卓9</h4><p>参考<a href=https://devices.ubuntu-touch.io/device/sargo/>https://devices.ubuntu-touch.io/device/sargo/</a></p><p>全翻墙的情况下，访问:</p><p><a href=https://flash.android.com/release>https://flash.android.com/release</a>,
按提示操作, 记得选择图示为<code>PQ3B.190801.002</code>的安卓9版本。</p><p><img src=/images/2022_01_25_09_06_50_621x486.jpg alt=/images/2022_01_25_09_06_50_621x486.jpg></p><p>看到此提示则代表刷入已经成功:</p><p><img src=/images/2022_01_25_07_58_49_612x183.jpg alt=/images/2022_01_25_07_58_49_612x183.jpg>
刷入成功后会提示需要lock bootloader，
按照提示先将bootloader锁定后，进入到安卓9中执行初始化操作.
接着进入到解锁bootloader以便刷Ubports.</p><h4 id=22-解锁bootloader>2.2 解锁bootloader:</h4><p>首先要做的是开启Usb调试
<code>关于手机</code>-><code>版本号</code>上狂点，直至打开<code>开发者模式</code>，
而后<code>系统</code>-><code>开发者选项</code>-><code>调试</code>-><code>USB调试</code>.</p><pre><code># adb devices
List of devices attached
xxxxxx5	device

# adb reboot bootloader
</code></pre><p>此时手机会停在fastboot阶段，在终端中继续敲入</p><pre><code># fastboot flashing unlock
OKAY [  0.338s]
Finished. Total time: 0.338s
</code></pre><p>此时在手机上按音量-键选择到<code>unlock bootloader</code>的选项后，继续按电源键确定。bootloader解锁成功后需重新启动并重新设置手机。此时需要重新开启usb调试等。</p><h4 id=23-刷入ubports>2.3 刷入ubports</h4><p>再次强调: ubports刷入的先决条件是pixel 3a上运行的安卓版本为<code>PQ3B.190801.002</code>。</p><p>ArchLinux上通过snap安装ubports刷机软件, 参考网址如下:</p><p><a href=https://snapcraft.io/install/ubports-installer/arch>https://snapcraft.io/install/ubports-installer/arch</a></p><p>开启刷机软件开始刷ubports:</p><pre><code>sudo ubports-installer
</code></pre><p><img src=/images/2022_01_25_08_25_47_803x441.jpg alt=/images/2022_01_25_08_25_47_803x441.jpg></p><p>确认手机型号:</p><p><img src=/images/2022_01_25_08_26_04_657x371.jpg alt=/images/2022_01_25_08_26_04_657x371.jpg></p><p>选择devel版(如果不是为了体验waydroid也可以选择为stable版), 一定要选择<code>wipe userdata</code>，否则刷机将一直卡顿不会成功:</p><p><img src=/images/2022_01_25_08_26_38_621x462.jpg alt=/images/2022_01_25_08_26_38_621x462.jpg></p><p>这里提示在fastboot菜单中需要选择为<code>Recovery Mode</code>才可以继续安装，在手机上按音量-键结合电源键选择，进入到恢复模式后点下一步:</p><p><img src=/images/2022_01_25_08_27_53_716x365.jpg alt=/images/2022_01_25_08_27_53_716x365.jpg></p><p>现在<code>ubports-installer</code>将自动下载镜像并进行刷机，刷机速度取决于下载速度,
推荐在空闲时段操作，在早上7、8点时大概几分钟时间刷好:</p><p><img src=/images/2022_01_25_08_29_20_554x581.jpg alt=/images/2022_01_25_08_29_20_554x581.jpg></p><p>刷机软件提示出以下界面的时候，手机将重启，这时需要耐心等待手机上的刷机进程完成写入操作，刷机过程中会有个黄色的小标志在不停转动， 而后将重启:</p><p><img src=/images/2022_01_25_08_31_21_651x492.jpg alt=/images/2022_01_25_08_31_21_651x492.jpg></p><p>经过一系列设置之后，Ubports将启动成功并进入到系统中。</p><h4 id=24-安装waydroid>2.4 安装waydroid</h4><p>确认自己安装的是开发者版本，如果是stable的话，在<code>关于</code>-><code>检查更新</code>下的配置按钮中，切换成开发者版本就可以了:</p><p><img src=/images/2022_01_25_08_47_25_478x309.jpg alt=/images/2022_01_25_08_47_25_478x309.jpg></p><p><code>waydroid</code>中也是可以使用adb命令的，使用adb命令连接到手机上后，运行waydroid的安装操作,
adb命令的一个参考如下(以下参考演示了如何连接到手机、如何从手机取回截屏):</p><pre><code>$ adb devices
List of devices attached
92UAY04L95	device

$ adb shell
phablet@ubuntu-phablet:~$ ls
Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos
phablet@ubuntu-phablet:~$ cd Pictures/
phablet@ubuntu-phablet:~/Pictures$ ls
Screenshots
phablet@ubuntu-phablet:~/Pictures$ cd Screenshots/
phablet@ubuntu-phablet:~/Pictures/Screenshots$ ls
screenshot20220125_084411555.png
phablet@ubuntu-phablet:~/Pictures/Screenshots$ exit

$ adb pull /home/phablet/Pictures/Screenshots/screenshot20220125_084411555.png
/home/phablet/Pictures/Screenshots/screenshot20220125_084411555.png: 1 file pulled, 0 skipped. 2.7 MB/s (76661 bytes in 0.027s)
</code></pre><p>可以检查一下磁盘占用情况, 确保安装waydroid具备足够的磁盘空间:</p><pre><code>dfphablet@ubuntu-phablet:~$ df -h
Filesystem       Size  Used Avail Use% Mounted on
/dev/root        3.0G  2.2G  804M  73% /
devtmpfs         1.7G  604K  1.7G   1% /dev
tmpfs            1.8G  1.3M  1.8G   1% /run
/dev/loop0       268M  267M     0 100% /android
/dev/mmcblk0p72   49G   27M   47G   1% /userdata
none             4.0K     0  4.0K   0% /sys/fs/cgroup
cgmfs            100K     0  100K   0% /run/cgmanager/fs
tmpfs            1.8G   32K  1.8G   1% /tmp
none             5.0M     0  5.0M   0% /run/lock
none             1.8G  172K  1.8G   1% /run/shm
none             100M     0  100M   0% /run/user
tmpfs            1.8G     0  1.8G   0% /media
tmpfs            1.8G     0  1.8G   0% /var/lib/openvpn/chroot/tmp
tmpfs            1.8G     0  1.8G   0% /var/lib/sudo
/dev/mmcblk0p71  755M  512M  228M  70% /android/vendor
tmpfs            1.8G     0  1.8G   0% /mnt/vendor
/dev/mmcblk0p48   35M  3.8M   30M  12% /mnt/vendor/persist
/dev/mmcblk0p66   12M   80K   11M   1% /android/metadata
/dev/mmcblk0p22   80M   72M  8.8M  90% /android/vendor/firmware_mnt
tmpfs            356M   40K  356M   1% /run/user/32011
tmpfs            356M     0  356M   0% /run/user/0
</code></pre><p><code>adb shell</code>下输入如下命令安装<code>waydroid</code>:</p><pre><code>sudo -s
sudo mount -o remount,rw /
apt update
apt install waydroid -y
waydroid init
</code></pre><p>值得注意的是，<code>waydroid init</code>需要从sourceforge拉取700MB左右的镜像，由于众所周知的原因，国内网络一直不是很好，这一步可能会耗费很长的时间。个人建议是在网络空闲时段(例如起个大早来跑)运行该操作。当然具备动手能力的可以用全翻墙网路来跑，速度会快很多。</p><p>waydroid命令实际上是一个python脚本，理论上是可以改一下调整它的镜像初始化机制以使用本地包用于离线安装的, 有兴趣的可以更改源码。</p><pre><code>root@ubuntu-phablet:~# which waydroid
/usr/bin/waydroid
root@ubuntu-phablet:~# cd /usr/lib/waydroid/
root@ubuntu-phablet:~# grep -i &quot;http&quot; ./ -r | grep channel
./tools/config/__init__.py:    &quot;system_channel&quot;: &quot;http://ota.waydro.id/system&quot;,
./tools/config/__init__.py:    &quot;vendor_channel&quot;: &quot;http://ota.waydro.id/vendor&quot;,
</code></pre><p>waydroid初始化过程:</p><pre><code>root@ubuntu-phablet:~# waydroid init
[08:55:02] Download https://sourceforge.net/projects/waydroid/files/images/system/lineage/waydroid_arm64/lineage-17.1-20211021-VANILLA-waydroid_arm64-system.zip/download
[09:04:37] Validating system image
[09:04:38] Extracting to /var/lib/waydroid/images
[09:05:22] Download https://sourceforge.net/projects/waydroid/files/images/vendor/waydroid_arm64/lineage-16.0-20211020-HALIUM_9-waydroid_arm64-vendor.zip/download
[09:05:42] Validating vendor image
[09:05:42] Extracting to /var/lib/waydroid/images
</code></pre><p>此时需要重启手机以继续安装。</p><h4 id=25-启动waydroid>2.5 启动waydroid</h4><p>启动完毕后，首先启动waydroid容器:</p><pre><code>$ adb shell
phablet@ubuntu-phablet:~$ sudo waydroid container start
[sudo] password for phablet: 

</code></pre><p>然后在另一个adb shell中启动waydroid session，
此时第一个shell里的命令会退出，接着就可以点开waydroid了:</p><pre><code>$ waydroid session start
[09:15:30] XDG Session is not &quot;wayland&quot;
[09:15:32] Failed to start Clipboard manager service, check logs
[09:15:51] Android with user 0 is ready
</code></pre><p>接着在手机里点开<code>wayroid</code>则可以开启waydroid界面.</p><p>启动这一步一直没太搞明白应该怎样才是正确的操作。但经历以上操作后，再次关机重启后，waydroid都可以直接在ubports下直接点开</p><p>如果遇到初始化问题不成功需要重新开始的话，可以使用以下命令清零waydroid安装:</p><pre><code>apt remove waydroid
apt purge waydroid
sudo rm -rf /var/lib/waydroid /home/.waydroid ~/waydroid ~/.share/waydroid ~/.local/share/applications/*aydroid* ~/.local/share/waydroid
</code></pre><h4 id=26-体验waydroid>2.6 体验waydroid</h4><p>安装应用宝:</p><pre><code>$ adb push MobileAssistant_1.apk /home/phablet/
MobileAssistant_1.apk: 1 file pushed, 0 skipped. 6.1 MB/s (10925622 bytes in 1.720s)
$ apks adb shell
phablet@ubuntu-phablet:~$ sudo waydroid app install ~/MobileAssistant_1.apk
[sudo] password for phablet: 
</code></pre><p><img src=/images/2022_01_25_09_25_18_406x838.jpg alt=/images/2022_01_25_09_25_18_406x838.jpg>
接下来的操作就是常规的安装apk, 使用apk。</p><p>鲁大师跑快40万分:</p><p><img src=/images/2022_01_25_09_49_20_405x834.jpg alt=/images/2022_01_25_09_49_20_405x834.jpg></p></div><ul class=pagination><li class=page-item><a href=/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/page/14/ class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/>1</a></li><li class=page-item><a class=page-link href=/page/2/>2</a></li><li class=page-item><a class=page-link href=/page/3/>3</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/14/>14</a></li><li class="page-item active"><a class=page-link href=/page/15/>15</a></li><li class=page-item><a class=page-link href=/page/16/>16</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/227/>227</a></li><li class=page-item><a href=/page/16/ class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/227/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>