<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta name=generator content="Hugo 0.64.0"><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Dash &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><link href=%7balternate%20%7bRSS%20application/rss+xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/index.xml%20http://purplepalmdash.github.io/index.xml%7d rel=alternate type=application/rss+xml title="Dash &#183; Dash"><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>很惭愧，就做了一点微小的工作</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=posts><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/11/02/migrationfromcentos76torocky/>MigrationFromCentOS76ToRocky</a></h1><span class=post-date>Nov 2, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=1-初始环境centos76>1. 初始环境(CentOS76)</h3><p>使用vagrant创建<code>CentOS7.6.1810</code>虚拟机一台:</p><pre><code># vim Vagrantfile
Vagrant.configure(&quot;2&quot;) do |config|
  config.vm.box = &quot;bento/centos-7.6&quot;
    config.vm.provider &quot;virtualbox&quot; do |v|
        v.memory = 4096
        v.cpus = 4
    end
end
# vagrant up 
# vagrant ssh
</code></pre><p>登陆入系统后检查初始环境信息:</p><pre><code>[vagrant@localhost ~]$ cat /etc/redhat-release 
CentOS Linux release 7.6.1810 (Core) 
[vagrant@localhost ~]$ uname -a
Linux localhost.localdomain 3.10.0-957.21.3.el7.x86_64 #1 SMP Tue Jun 18 16:35:19 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
</code></pre><h3 id=2-centos76升级到centos81>2. CentOS7.6升级到CentOS8.1</h3><h4 id=21-升级前准备>2.1 升级前准备</h4><p>安装EPEL(Extra Package for Enterprise Linux)库，因升级中需用到该库, 并创建该库缓存:</p><pre><code># yum install -y epel-release.noarch
# yum makecache fast
</code></pre><p>安装升级CentOS 7到8过程中需要用到的<code>rpmconf</code>包及<code>yum-utils</code>包:</p><pre><code># yum install -y yum-utils rpmconf
</code></pre><p>计算重复/无用包及配置:</p><pre><code># rpmconf -a
安装过程中，选择 N:  
*** aliases (Y/I/N/O/D/M/Z/S) [default=N] ? 
Your choice: N
</code></pre><p>升级<code>yum</code>为<code>dnf</code>，安装完毕后，删除不再需要的yum及相关包：</p><pre><code># yum install -y dnf
# dnf remove -y yum yum-metadata-parser
</code></pre><p>删除现有的repo配置并重新生成仓库缓存, 并使用dnf升级为最新状态:</p><pre><code># rm -Rf /etc/yum
#  dnf makecache
Extra Packages for Enterprise Linux 7 - x86_64   5.9 MB/s |  16 MB     00:02    
CentOS-7 - Base                                  4.1 MB/s |  10 MB     00:02    
CentOS-7 - Updates                               7.6 MB/s |  21 MB     00:02    
CentOS-7 - Extras                                165 kB/s | 332 kB     00:02    
Metadata cache created.
# dnf upgrade -y
</code></pre><h4 id=22-升级8仓库准备>2.2 升级8仓库准备</h4><p>跨大版本升级可能会衍生出一些问题，因而我们先使用8.1版本的CentOS8系统包作为中间状态升级:</p><pre><code># dnf upgrade -y  https://mirrors.ustc.edu.cn/centos-vault/8.1.1911//BaseOS/x86_64/os/Packages/{centos-release-8.1-1.1911.0.8.el8.x86_64.rpm,centos-gpg-keys-8.1-1.1911.0.8.el8.noarch.rpm,centos-repos-8.1-1.1911.0.8.el8.x86_64.rpm}
</code></pre><p>升级EPEL仓库包从EL 7到EL 8:</p><pre><code># dnf upgrade -y epel-release
</code></pre><p>因跨大版本升级可能会导致问题，切换<code>BaseOS</code>及<code>AppStream</code>库为<code>8.1.1911</code>:</p><pre><code># cd /etc/yum.repos.d
# mkdir back
# mv CentOS-* back/
# sudo tee CentOS-Linux-BaseOS.repo&lt;&lt;EOM
[baseos]
name=CentOS Linux \$releasever - BaseOS
baseurl=http://vault.centos.org/8.1.1911/BaseOS/\$basearch/os/
gpgcheck=1
enabled=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
EOM

# sudo tee CentOS-Linux-AppStream.repo&lt;&lt;EOM
[appstream]
name=CentOS Linux \$releasever - AppStream
baseurl=http://vault.centos.org/8.1.1911/AppStream/\$basearch/os/
gpgcheck=1
enabled=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
EOM
# sudo cp CentOS-Linux-BaseOS.repo /root/CentOS-Linux-BaseOS.repo
# sudo cp CentOS-Linux-AppStream.repo /root/CentOS-Linux-AppStream.repo
# dnf makecache
Extra Packages for Enterprise Linux 8 - x86_64                4.7 MB/s |  13 MB     00:02    
CentOS-8 - Base                                               1.1 MB/s | 4.6 MB     00:04    
Extra Packages for Enterprise Linux Modular 8 - x86_64        197 kB/s | 733 kB     00:03    
CentOS-8 - AppStream                                          1.3 MB/s | 8.4 MB     00:06    
CentOS-8 - Extras                                             4.3 kB/s |  10 kB     00:02    
Module yaml error: Unexpected key in data
Module yaml error: Unexpected key in data
Module yaml error: Unexpected key in data
Module yaml error: Unexpected key in data
Module defaults error: Unexpected key in data
Module defaults error: Unexpected key in data
Module defaults error: Unexpected key in data
Module defaults error: Unexpected key in data
Metadata cache created.
</code></pre><h4 id=23-升级到centos-8>2.3 升级到CentOS 8</h4><p>删除所有安装过的kernel:</p><pre><code># rpm -e `rpm -q kernel`
</code></pre><p>删除<code>sysvinit-tools</code>等冲突包：</p><pre><code># rpm -e --nodeps sysvinit-tools sysvinit-tools python36-rpmconf 
</code></pre><p>执行以下命令，升级到CentOS 8:</p><pre><code># dnf -y --releasever=8 --allowerasing --setopt=deltarpm=false distro-sync
</code></pre><p>升级成功后，<code>/etc/yum.repos.d</code>目录下会被覆盖，回归到8.1版本</p><pre><code># cd /etc/yum.repos.d
# mkdir back1
# mv CentOS-* back1/
# sudo cp /root/CentOS-Linux-BaseOS.repo .
# sudo cp /root/CentOS-Linux-AppStream.repo .
</code></pre><p>安装内核包:</p><pre><code># dnf makecache
# dnf install -y kernel-core
</code></pre><p>安装<code>minimal</code>及<code>Core</code>包组合:</p><pre><code># mv /etc/yum/protected.d /etc/yum/protected.d.back
# dnf -y groupupdate &quot;Core&quot; &quot;Minimal Install&quot;
</code></pre><h4 id=24-升级centos85>2.4 升级CentOS8.5</h4><p>回归原来的包配置:</p><pre><code># cd /etc/yum.repos.d/
# rm -f CentOS-*
# mv back1/* .
# CENTOS_BASE=http://vault.centos.org
# sed -i -e &quot;s|mirrorlist=|#mirrorlist=|g&quot; /etc/yum.repos.d/CentOS-* 
# sed -i -e 's|#baseurl=http://mirror.centos.org|baseurl='$CENTOS_BASE'|g' /etc/yum.repos.d/CentOS-*
# dnf update
</code></pre><p>更新完毕后，重启，而后检查内核及操作系统版本:</p><pre><code># uname -a
Linux localhost.localdomain 4.18.0-348.7.1.el8_5.x86_64 #1 SMP Wed Dec 22 13:25:12 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
# cat /etc/redhat-release 
CentOS Linux release 8.5.2111
</code></pre><h3 id=3-centos-8---rocky-linux-8>3. CentOS 8 -> Rocky Linux 8</h3><p>下载Rocky Linux升级脚本:</p><pre><code># dnf -y install wget
# wget https://raw.githubusercontent.com/rocky-linux/rocky-tools/main/migrate2rocky/migrate2rocky.sh
# chmod a+x migrate2rocky.sh
</code></pre><p>升级到Rocky Linux 8.6:</p><pre><code>./migrate2rocky.sh -r
</code></pre><p><img src=/images/2022_11_02_16_04_40_865x689.jpg alt=/images/2022_11_02_16_04_40_865x689.jpg></p><p>等待一段时间(取决于网速及机器配置，vagrant虚拟机约15分钟)，等待升级完成:</p><p><img src=/images/2022_11_02_16_11_03_707x457.jpg alt=/images/2022_11_02_16_11_03_707x457.jpg></p><h3 id=4-验证>4. 验证</h3><p>重启该机器后，验证升级情况:</p><pre><code>[vagrant@localhost ~]$ uname -a
Linux localhost.localdomain 4.18.0-372.32.1.el8_6.x86_64 #1 SMP Thu Oct 27 15:18:36 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
[vagrant@localhost ~]$ cat /etc/os-release
NAME=&quot;Rocky Linux&quot;
VERSION=&quot;8.6 (Green Obsidian)&quot;
ID=&quot;rocky&quot;
ID_LIKE=&quot;rhel centos fedora&quot;
VERSION_ID=&quot;8.6&quot;
PLATFORM_ID=&quot;platform:el8&quot;
PRETTY_NAME=&quot;Rocky Linux 8.6 (Green Obsidian)&quot;
ANSI_COLOR=&quot;0;32&quot;
CPE_NAME=&quot;cpe:/o:rocky:rocky:8:GA&quot;
HOME_URL=&quot;https://rockylinux.org/&quot;
BUG_REPORT_URL=&quot;https://bugs.rockylinux.org/&quot;
ROCKY_SUPPORT_PRODUCT=&quot;Rocky Linux&quot;
ROCKY_SUPPORT_PRODUCT_VERSION=&quot;8&quot;
REDHAT_SUPPORT_PRODUCT=&quot;Rocky Linux&quot;
REDHAT_SUPPORT_PRODUCT_VERSION=&quot;8&quot;
</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/10/26/windowsvirtualboxucc/>WindowsVirtualBoxUCC</a></h1><span class=post-date>Oct 26, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=env-preparation>Env Preparation</h3><p>Install VirtualBox 7.0.2:</p><p><img src=/images/2022_10_26_09_19_41_455x301.jpg alt=/images/2022_10_26_09_19_41_455x301.jpg></p><p>View version:</p><p><img src=/images/2022_10_26_09_20_32_843x589.jpg alt=/images/2022_10_26_09_20_32_843x589.jpg></p><p>Disable the dhcp server for default <code>Host-only Networks</code>:</p><p><img src=/images/2022_10_26_09_27_37_627x467.jpg alt=/images/2022_10_26_09_27_37_627x467.jpg></p><h3 id=vm-creation>VM Creation</h3><p>Create a new vm(type <code>Linux->Other Linux</code>):</p><p><img src=/images/2022_10_26_09_29_24_778x373.jpg alt=/images/2022_10_26_09_29_24_778x373.jpg></p><p>2 Cores, 2048MB Memory:</p><p><img src=/images/2022_10_26_09_29_56_643x203.jpg alt=/images/2022_10_26_09_29_56_643x203.jpg></p><p>Specify <code>centos85.vdi</code> file for hard disk:</p><p><img src=/images/2022_10_26_09_30_38_648x273.jpg alt=/images/2022_10_26_09_30_38_648x273.jpg></p><p>Configure the vm to specify its networking:</p><p><img src=/images/2022_10_26_09_31_24_804x391.jpg alt=/images/2022_10_26_09_31_24_804x391.jpg></p><p>Visit <code>https://192.168.56.199</code> should reach the ucc server web admin page:</p><p><img src=/images/2022_10_26_09_34_44_771x540.jpg alt=/images/2022_10_26_09_34_44_771x540.jpg></p><h3 id=ucc-client-testing>UCC Client Testing</h3><p>Create a new machine(type <code>Windows 10</code>):</p><p><img src=/images/2022_10_26_09_36_04_747x326.jpg alt=/images/2022_10_26_09_36_04_747x326.jpg></p><p>2 Cores, 3072 MB Memory, Enable EFI:</p><p><img src=/images/2022_10_26_09_36_49_648x238.jpg alt=/images/2022_10_26_09_36_49_648x238.jpg></p><p>Create 50 GB disk:</p><p><img src=/images/2022_10_26_09_37_09_646x267.jpg alt=/images/2022_10_26_09_37_09_646x267.jpg></p><p>Configure this VM, select <code>ICH9</code> as its chipset:</p><p><img src=/images/2022_10_26_09_38_41_620x481.jpg alt=/images/2022_10_26_09_38_41_620x481.jpg></p><p>Enable Network as its boot sequence:</p><p><img src=/images/2022_10_26_09_40_04_594x370.jpg alt=/images/2022_10_26_09_40_04_594x370.jpg></p><p>Change Network to <code>host-only</code> type:</p><p><img src=/images/2022_10_26_09_42_16_713x344.jpg alt=/images/2022_10_26_09_42_16_713x344.jpg></p><p>System will boot into EFI shell, input <code>exit</code> to bios:</p><p><img src=/images/2022_10_26_09_40_52_603x279.jpg alt=/images/2022_10_26_09_40_52_603x279.jpg></p><p>Select <code>Boot Manage</code>, press enter:</p><p><img src=/images/2022_10_26_09_41_13_582x236.jpg alt=/images/2022_10_26_09_41_13_582x236.jpg></p><p>Select <code>UEFI PXEv4</code> for booting:</p><p><img src=/images/2022_10_26_09_41_34_638x346.jpg alt=/images/2022_10_26_09_41_34_638x346.jpg></p><p>pxe will boot into register name, input name <code>ucctestwin10</code> for continue:</p><p><img src=/images/2022_10_26_09_44_19_1152x854.jpg alt=/images/2022_10_26_09_44_19_1152x854.jpg></p><p>Click setup button for initialization this node:</p><p><img src=/images/2022_10_26_09_45_11_958x620.jpg alt=/images/2022_10_26_09_45_11_958x620.jpg></p><p>Initialize the disk using the default parameters:</p><p><img src=/images/2022_10_26_09_46_25_1706x560.jpg alt=/images/2022_10_26_09_46_25_1706x560.jpg></p><p>Now return to login page, the <code>disk</code> and <code>network</code> indication should be green, enter username/password for continue:</p><p><img src=/images/2022_10_26_09_49_10_470x605.jpg alt=/images/2022_10_26_09_49_10_470x605.jpg></p><p>Click <code>TCI</code> for downloading the package and boot into windows 10:</p><p><img src=/images/2022_10_26_09_49_59_1529x871.jpg alt=/images/2022_10_26_09_49_59_1529x871.jpg></p><p>windows 10 in virtualbox:</p><p><img src=/images/2022_10_26_09_59_21_909x816.jpg alt=/images/2022_10_26_09_59_21_909x816.jpg></p><p>Don&rsquo;t try <code>idv</code>, cause in virtualbox it will run into error:</p><p><img src=/images/2022_10_26_10_00_56_1024x531.jpg alt=/images/2022_10_26_10_00_56_1024x531.jpg></p><h3 id=ubuntu-verification>Ubuntu Verification</h3><p>Upload the image and copy it into corresponding directory:</p><p><img src=/images/2022_10_26_10_30_02_651x127.jpg alt=/images/2022_10_26_10_30_02_651x127.jpg></p><p>Register image in UCC Server admin pages:</p><p><img src=/images/2022_10_26_10_31_04_714x559.jpg alt=/images/2022_10_26_10_31_04_714x559.jpg></p><p>Create a new machine for testing Ubuntu:</p><p><img src=/images/2022_10_26_10_31_44_633x307.jpg alt=/images/2022_10_26_10_31_44_633x307.jpg></p><p>2Core, 2048 MB , enable uefi:</p><p><img src=/images/2022_10_26_10_32_08_663x260.jpg alt=/images/2022_10_26_10_32_08_663x260.jpg></p><p>Select <code>ICH9</code> for chipset, and enable the network boot:</p><p><img src=/images/2022_10_26_10_32_57_681x426.jpg alt=/images/2022_10_26_10_32_57_681x426.jpg></p><p>Change the network:</p><p><img src=/images/2022_10_26_10_33_13_568x366.jpg alt=/images/2022_10_26_10_33_13_568x366.jpg></p><p><code>exit</code> and into the bios:</p><p><img src=/images/2022_10_26_10_34_06_616x290.jpg alt=/images/2022_10_26_10_34_06_616x290.jpg></p><p>Boot Manager and select <code>UEFI PXEv4</code>:</p><p><img src=/images/2022_10_26_10_34_33_600x419.jpg alt=/images/2022_10_26_10_34_33_600x419.jpg></p><p>Register client:</p><p><img src=/images/2022_10_26_10_35_33_658x218.jpg alt=/images/2022_10_26_10_35_33_658x218.jpg></p><p>Initialize the disk:</p><p><img src=/images/2022_10_26_10_36_03_1413x407.jpg alt=/images/2022_10_26_10_36_03_1413x407.jpg></p><p>Select Ubuntu for downloading and boot into system:</p><p><img src=/images/2022_10_26_10_37_38_1001x301.jpg alt=/images/2022_10_26_10_37_38_1001x301.jpg></p><p>Ubuntu desktop:</p><p><img src=/images/2022_10_26_10_41_47_809x720.jpg alt=/images/2022_10_26_10_41_47_809x720.jpg></p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/10/25/workingtipsonucc/>WorkingTipsOnucc</a></h1><span class=post-date>Oct 25, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><p>Create a inner networking for testing:</p><p><img src=/images/2022_10_25_09_48_58_519x557.jpg alt=/images/2022_10_25_09_48_58_519x557.jpg></p><p>Select the inner networking for imported vm:</p><p><img src=/images/2022_10_25_09_49_48_719x410.jpg alt=/images/2022_10_25_09_49_48_719x410.jpg></p><p>Change vm&rsquo;s ip address configuration:</p><p><img src=/images/2022_10_25_09_52_46_481x379.jpg alt=/images/2022_10_25_09_52_46_481x379.jpg></p><p>Check the changed ip configuration:</p><p><img src=/images/2022_10_25_09_53_37_639x193.jpg alt=/images/2022_10_25_09_53_37_639x193.jpg></p><p>visit <code>https://10.17.18.2</code> for changing ucc server configuration:</p><p><img src=/images/2022_10_25_09_54_54_541x562.jpg alt=/images/2022_10_25_09_54_54_541x562.jpg></p><p>Changed the <code>server address</code>:</p><p><img src=/images/2022_10_25_09_59_20_312x164.jpg alt=/images/2022_10_25_09_59_20_312x164.jpg></p><p>Change the dhcp service:</p><p><img src=/images/2022_10_25_10_01_51_448x397.jpg alt=/images/2022_10_25_10_01_51_448x397.jpg></p><p>Delete all of the registed server:</p><p><img src=/images/2022_10_25_10_04_49_817x322.jpg alt=/images/2022_10_25_10_04_49_817x322.jpg></p><h3 id=verification>Verification</h3><p>Create 2 vm images file under <code>/var/lib/libvirt/images</code>:</p><pre><code># qemu-img create -f qcow2 win1.qcow2 50G
# qemu-img create -f qcow2 win2.qcow2 50G
</code></pre><p>Manually import :</p><p><img src=/images/2022_10_25_10_10_19_423x263.jpg alt=/images/2022_10_25_10_10_19_423x263.jpg></p><p>2 core, 4096 MiB memory. Select win1.qcow2:</p><p><img src=/images/2022_10_25_10_11_07_396x234.jpg alt=/images/2022_10_25_10_11_07_396x234.jpg></p><p>uefi relatd configuration:</p><p><img src=/images/2022_10_25_10_13_03_786x544.jpg alt=/images/2022_10_25_10_13_03_786x544.jpg></p><p>Select Nic:</p><p><img src=/images/2022_10_25_10_13_28_581x324.jpg alt=/images/2022_10_25_10_13_28_581x324.jpg></p><p>Change the boot options:</p><p><img src=/images/2022_10_25_10_15_40_469x345.jpg alt=/images/2022_10_25_10_15_40_469x345.jpg></p><p>Configuration:</p><p><img src=/images/2022_10_25_10_20_34_465x219.jpg alt=/images/2022_10_25_10_20_34_465x219.jpg></p><p>Initialize the disk:</p><p><img src=/images/2022_10_25_10_21_09_1830x619.jpg alt=/images/2022_10_25_10_21_09_1830x619.jpg></p><p>Succeed:</p><p><img src=/images/2022_10_25_10_22_25_1172x265.jpg alt=/images/2022_10_25_10_22_25_1172x265.jpg></p><p>Login with <code>user1</code>:</p><p><img src=/images/2022_10_25_10_23_12_448x582.jpg alt=/images/2022_10_25_10_23_12_448x582.jpg></p><p>Select the <code>TCI</code> for downloading:</p><p><img src=/images/2022_10_25_10_23_46_541x315.jpg alt=/images/2022_10_25_10_23_46_541x315.jpg></p><h3 id=virtualbox-way>Virtualbox way</h3><p>Create vm and import:</p><p><img src=/images/2022_10_25_11_28_49_964x545.jpg alt=/images/2022_10_25_11_28_49_964x545.jpg></p><p>Import vm disk:</p><p><img src=/images/2022_10_25_11_30_03_1059x541.jpg alt=/images/2022_10_25_11_30_03_1059x541.jpg></p><p>Create network(without dhcp):</p><p><img src=/images/2022_10_25_11_31_46_520x218.jpg alt=/images/2022_10_25_11_31_46_520x218.jpg></p><p>Choose the network:</p><p><img src=/images/2022_10_25_11_32_23_802x439.jpg alt=/images/2022_10_25_11_32_23_802x439.jpg></p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/09/30/workingtipsonproxmoxgvtg/>WorkingTipsOnProxmoxGVTG</a></h1><span class=post-date>Sep 30, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=change-configuration>Change configuration</h3><p>Change grub options:</p><pre><code># vi /etc/default/grub
GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet&quot;
TO
GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet intel_iommu=on iommu=pt i915.enable_gvt=1&quot;

# vi /etc/modules
vfio
vfio_iommu_type1
vfio_pci
vfio_virqfd
kvmgt
</code></pre><p>Update:</p><pre><code># update-grub2
# update-initramfs -u -k all
</code></pre><h3 id=check-status>Check status:</h3><p>Check iommu features:</p><pre><code># dmesg | grep -e DMAR -e IOMMU -e AMD-Vi
# find /sys/kernel/iommu_groups/ -type l
</code></pre><p>Get the VGA related:</p><pre><code>root@pve:~# lspci | grep -i vga
00:02.0 VGA compatible controller: Intel Corporation HD Graphics 630 (rev 04)
root@pve:~# ls /sys/bus/pci/devices/0000\:00\:02.0/mdev_supported_types/
i915-GVTg_V5_4	i915-GVTg_V5_8
</code></pre><h3 id=vm-installation>vm installation</h3><p>Create a vm (win7) like:</p><p><img src=/images/2022_09_30_10_01_06_720x245.jpg alt=/images/2022_09_30_10_01_06_720x245.jpg></p><p><img src=/images/2022_09_30_10_02_04_724x216.jpg alt=/images/2022_09_30_10_02_04_724x216.jpg></p><p>Add PCI device:</p><p><img src=/images/2022_09_30_10_03_54_614x173.jpg alt=/images/2022_09_30_10_03_54_614x173.jpg></p><p>hardware:</p><p><img src=/images/2022_09_30_10_04_22_961x349.jpg alt=/images/2022_09_30_10_04_22_961x349.jpg></p><p>Then install the windows in console.</p><p>Install &ldquo;Jianjizhi&rdquo; and test usage.</p><p><img src=/images/2022_09_30_10_30_50_943x660.jpg alt=/images/2022_09_30_10_30_50_943x660.jpg></p><p>Install intel video:</p><p><img src=/images/2022_09_30_10_31_52_599x404.jpg alt=/images/2022_09_30_10_31_52_599x404.jpg></p><p><img src=/images/2022_09_30_10_32_15_427x337.jpg alt=/images/2022_09_30_10_32_15_427x337.jpg></p><p>Select <code>Install this driver software anyway</code>:</p><p><img src=/images/2022_09_30_10_32_37_549x382.jpg alt=/images/2022_09_30_10_32_37_549x382.jpg></p><p>Select <code>reboot this computer now</code>:</p><p><img src=/images/2022_09_30_10_33_49_438x342.jpg alt=/images/2022_09_30_10_33_49_438x342.jpg></p><p>Status:</p><p><img src=/images/2022_09_30_10_43_27_657x467.jpg alt=/images/2022_09_30_10_43_27_657x467.jpg></p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2022/09/28/workingtipsonxengt/>WorkingtipsOnXenGT</a></h1><span class=post-date>Sep 28, 2022<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=hardware>hardware</h3><p>hardware:</p><pre><code>$ cat /proc/cpuinfo | grep model
model		: 60
model name	: Intel(R) Core(TM) i5-4460  CPU @ 3.20GHz
$ free -g
             total       used       free     shared    buffers     cached
Mem:            30          1         29          0          0          0
-/+ buffers/cache:          0         30
Swap:            0          0          0
dash@ubuntu1404:~$ cat /etc/issue
Ubuntu 14.04.5 LTS \n \l

dash@ubuntu1404:~$ uname -a
Linux ubuntu1404 4.4.0-31-generic #50~14.04.1-Ubuntu SMP Wed Jul 13 01:07:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux

</code></pre><p>Install ubuntu14.04, change repository to <code>mirrors.ustc.edu.cn</code>, then install packages:</p><pre><code># apt-get install libarchive-dev libghc-bzlib-dev  zlib1g-dev mercurial gettext bcc iasl uuid-dev libncurses5-dev kpartx bc libperl-dev libgtk2.0-dev libc6-dev-i386 libaio-dev libsdl1.2-dev nfs-common libyajl-dev libx11-dev autoconf libtool xsltproc bison flex xutils-dev xserver-xorg-dev x11proto-gl-dev libx11-xcb-dev vncviewer libxcb-glx0 libxcb-glx0-dev libxcb-dri2-0-dev libxcb-xfixes0-dev bridge-utils python-dev bin86 git vim libssl-dev pciutils-dev tightvncserver ssh texinfo -y
</code></pre><h3 id=check>Check</h3><p>Before install driver:</p><p><img src=/images/2022_09_29_10_00_16_732x530.jpg alt=/images/2022_09_29_10_00_16_732x530.jpg></p><p>Install driver:</p><p><img src=/images/2022_09_29_10_06_34_519x420.jpg alt=/images/2022_09_29_10_06_34_519x420.jpg></p><p>Restart the machine, check the driver status:</p></div><ul class=pagination><li class=page-item><a href=/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/page/28/ class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/>1</a></li><li class=page-item><a class=page-link href=/page/2/>2</a></li><li class=page-item><a class=page-link href=/page/3/>3</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/28/>28</a></li><li class="page-item active"><a class=page-link href=/page/29/>29</a></li><li class=page-item><a class=page-link href=/page/30/>30</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/248/>248</a></li><li class=page-item><a href=/page/30/ class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/248/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>