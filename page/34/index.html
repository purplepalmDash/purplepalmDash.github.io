<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta name=generator content="Hugo 0.64.0"><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Dash &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><link href=%7balternate%20%7bRSS%20application/rss+xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/index.xml%20http://purplepalmdash.github.io/index.xml%7d rel=alternate type=application/rss+xml title="Dash &#183; Dash"><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>很惭愧，就做了一点微小的工作</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=posts><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/27/joggleropenframe/>JogglerOpenFrame</a></h1><span class=post-date>Sep 27, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=reflash-latest-firmware>Reflash latest firmware</h3><p>Examine the disk and write the image to disk:</p><pre><code>Disk /dev/sdd：1.88 GiB，2021654528 字节，3948544 个扇区
磁盘型号：                
单元：扇区 / 1 * 512 = 512 字节
扇区大小(逻辑/物理)：512 字节 / 512 字节
I/O 大小(最小/最佳)：512 字节 / 512 字节
磁盘标签类型：dos
磁盘标识符：0x2fbbe9fe

设备       启动 起点    末尾    扇区  大小 Id 类型
/dev/sdd1  *       0 1390591 1390592  679M  0 空
/dev/sdd2        264  131335  131072   64M ef EFI (FAT-12/16/32)
dash@archnvme:/media/sda $ cd ~/Downloads 
dash@archnvme:~/Downloads $ sudo su   
[root@archnvme Downloads]# gzip -dc reflash111_of.img.gz | dd of=/dev/sdd bs=1M
</code></pre><p>Mount reflash&rsquo;s usb disk into computer:</p><pre><code>Mount the USB device on your system; you should see a volume named rfl-boot.
On the rfl-boot volume there is a directory named reflash.
Download the operating system image you would like to write, along with its MD5 file.
Copy both the compressed .img.gz file and its .img.gz.md5 counterpart into the reflash directory.
</code></pre><p>Now insert the flashed usb disk into joggler, then flash will begin.</p><p>After flashing, could poweron from flash.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/24/visualstudiocodemarkdownwriting/>VisualStudioCodeMarkdownWriting</a></h1><span class=post-date>Sep 24, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=installation>Installation</h3><p>Install microsoft visual studio code via:</p><pre><code>$ sudo vim /etc/pacman.conf
[archlinuxcn]
#The Chinese Arch Linux communities packages.
SigLevel = Never
Server   = http://repo.archlinuxcn.org/$arch
$ sudo pacman -Sy
$ sudo pacman -S visual-studio-code-bin
</code></pre><h3 id=install-plugin>Install Plugin</h3><p>Install via:</p><p><img src=/images/2020_09_24_09_58_02_326x285.jpg alt=/images/2020_09_24_09_58_02_326x285.jpg></p><p>Install prince(for converting to pdf)via:</p><pre><code>$ sudo pacman -S prince-bin
</code></pre><p>Configure the stylesheet for prince&rsquo;s generated output:</p><pre><code>$ cat ~/.mume/style.less
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */ 

.markdown-preview.markdown-preview {
  // modify your style here
  // eg: background-color: blue;  
  &amp;.prince {
    @page {
      //size: A4 landscape
      size: A4 PortraitModes
    }
    @font-face {
      font-family: sans-serif;
      font-style: normal;
      font-weight: normal;
      src: url(&quot;/usr/share/fonts/adobe-source-han-sans/SourceHanSansCN-Regular.otf&quot;)
  }

  @font-face {
      font-family: sans-serif;
      font-style: normal;
      font-weight: bold;
      src: url(&quot;/usr/share/fonts/adobe-source-han-sans/SourceHanSansCN-Bold.otf&quot;)
  }

  @font-face {
      font-family: sans-serif;
      font-style: italic;
      font-weight: normal;
      src: url(&quot;/usr/share/fonts/adobe-source-code-pro/SourceCodePro-It.otf&quot;)
      //src: url(&quot;/usr/share/fonts/adobe-source-han-sans/SourceHanSansCN-Regular.otf&quot;)
  }

  @font-face {
      font-family: sans-serif;
      font-style: italic;
      font-weight: bold;
      src: url(&quot;/usr/share/fonts/adobe-source-code-pro/SourceCodePro-BoldIt.otf&quot;)
      //src: url(&quot;/usr/share/fonts/adobe-source-han-sans/SourceHanSansCN-Bold.otf&quot;)
  }
  }
}
</code></pre><p>Or edit the css via <code>ctrl+shift+p</code> and Run <code>Markdown Preview Enhanced: Customize Css</code>, Insert the above code.</p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/15/usbdisplaylinkworkinghowto/>USBDisplayLinkWorkingHowto</a></h1><span class=post-date>Sep 15, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=find-usb-equipment>Find USB Equipment</h3><p>Via lsusb we could find which usb equipment available:</p><pre><code>$ sudo lsusb -t 
/:  Bus 02.Port 1: Dev 1, Class=root_hub, Driver=xhci_hcd/8p, 10000M
    |__ Port 5: Dev 2, If 0, Class=Hub, Driver=hub/4p, 5000M
/:  Bus 01.Port 1: Dev 1, Class=root_hub, Driver=xhci_hcd/16p, 480M
    |__ Port 2: Dev 2, If 0, Class=Vendor Specific Class, Driver=rtsx_usb, 480M
    |__ Port 3: Dev 3, If 0, Class=Vendor Specific Class, Driver=asix, 480M
    |__ Port 6: Dev 4, If 0, Class=Human Interface Device, Driver=, 12M
    |__ Port 6: Dev 4, If 1, Class=Human Interface Device, Driver=usbhid, 12M
    |__ Port 9: Dev 5, If 0, Class=Hub, Driver=hub/4p, 480M
        |__ Port 1: Dev 7, If 1, Class=Human Interface Device, Driver=usbhid, 12M
        |__ Port 1: Dev 7, If 0, Class=Human Interface Device, Driver=usbhid, 12M
        |__ Port 2: Dev 9, If 0, Class=Human Interface Device, Driver=usbhid, 12M
        |__ Port 3: Dev 10, If 0, Class=Wireless, Driver=rndis_host, 480M
        |__ Port 3: Dev 10, If 1, Class=CDC Data, Driver=rndis_host, 480M
        |__ Port 4: Dev 12, If 0, Class=Vendor Specific Class, Driver=udl, 480M
    |__ Port 12: Dev 13, If 0, Class=Mass Storage, Driver=usb-storage, 480M
    |__ Port 13: Dev 6, If 1, Class=Video, Driver=uvcvideo, 480M
    |__ Port 13: Dev 6, If 0, Class=Video, Driver=uvcvideo, 480M
    |__ Port 14: Dev 8, If 0, Class=Wireless, Driver=btusb, 12M
    |__ Port 14: Dev 8, If 1, Class=Wireless, Driver=btusb, 12M
</code></pre><p>And we could found corresponding USB equipments:</p><pre><code>$ ls /sys/bus/usb/drivers/usb
1-12  1-13  1-14  1-2  1-3  1-6  1-9  1-9.1  1-9.2  1-9.3  1-9.4  2-5  bind  uevent  unbind  usb1  usb2
</code></pre><p>Via following command we could unbind/bind DisplayLink equipments:</p><pre><code>$ echo '1-9.4' | sudo tee /sys/bus/usb/drivers/usb/unbind
$ echo '1-9.4' | sudo tee /sys/bus/usb/drivers/usb/bind
</code></pre><p><code>unbind</code> is equal to unplugin the usb port, <code>bind</code> is equal to insert the usb equipment.</p><h3 id=xrandr-tips>xrandr tips</h3><p>Via following commands:</p><pre><code>$ xrandr --output DVI-I-2-2  --mode 1920x1080 --right-of HDMI-0'
</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/09/workingtipsonlxcko/>WorkingTipsOnLXCKO</a></h1><span class=post-date>Sep 9, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=environment>Environment</h3><p>Ubuntu 18.04.3 LTS, Kernel version:<br><code>Linux build 5.3.0-62-generic</code>.</p><p>vagrant box image: <code>centos76</code>.</p><p>lxc images:</p><pre><code># apt-get install -y kpartx
# cp ~/.vagrant.d/boxes/centos76/0/libvirt/box.img  /media/sdb/
# cd /media/sdb

root@build:/media/sdb# qemu-img convert box.img box1.img
root@build:/media/sdb# qemu-img info box.img
image: box.img
file format: qcow2
virtual size: 200G (214748364800 bytes)
disk size: 655M
cluster_size: 65536
Format specific information:
    compat: 1.1
    lazy refcounts: false
    refcount bits: 16
    corrupt: false
root@build:/media/sdb# qemu-img info box1.img
image: box1.img
file format: raw
virtual size: 200G (214748364800 bytes)
disk size: 1.3G

# kpartx -av box1.img 
add map loop2p1 (253:2): 0 419428352 linear 7:2 2048
# mount /dev/mapper/loop2p1 /mnt8/
# ls /mnt8/
bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
# tar -cvzf rootfs.tar.gz -C /mnt8 .
</code></pre><p>Create metadata and import lxc images:</p><pre><code># vim metadata.yaml
architecture: &quot;x86_64&quot;
creation_date: 1599622122 # To get current date in Unix time, use `date +%s` command
properties:
architecture: &quot;x86_64&quot;
description: &quot;CentOS 7.6 for lxc&quot;
os: &quot;redhat&quot;
release: &quot;7.6&quot;
# tar czvf metadata.tar.gz metadata.yaml
# lxc image import metadata.tar.gz rootfs.tar.gz --alias &quot;centos76&quot;
Image imported with fingerprint: 9f53f37e869c643049933dccf8cac9c76107856b1f66955cc2a9d3a55329a060
# lxc image ls
+----------+--------------+--------+-------------+--------+----------+-----------------------------+
|  ALIAS   | FINGERPRINT  | PUBLIC | DESCRIPTION |  ARCH  |   SIZE   |         UPLOAD DATE         |
+----------+--------------+--------+-------------+--------+----------+-----------------------------+
| centos76 | 9f53f37e869c | no     |             | x86_64 | 473.97MB | Sep 9, 2020 at 3:29am (UTC) |
+----------+--------------+--------+-------------+--------+----------+-----------------------------+
</code></pre><p>lxd init using following configuration:</p><pre><code>root@build:/media/sdb# lxd init
Would you like to use LXD clustering? (yes/no) [default=no]: 
Do you want to configure a new storage pool? (yes/no) [default=yes]: 
Name of the new storage pool [default=default]: 
Name of the storage backend to use (btrfs, dir, lvm) [default=btrfs]: 
Create a new BTRFS pool? (yes/no) [default=yes]: 
Would you like to use an existing block device? (yes/no) [default=no]: ^C
root@build:/media/sdb# lxd init
Would you like to use LXD clustering? (yes/no) [default=no]: 
Do you want to configure a new storage pool? (yes/no) [default=yes]: 
Name of the new storage pool [default=default]: 
Name of the storage backend to use (btrfs, dir, lvm) [default=btrfs]: dir
Would you like to connect to a MAAS server? (yes/no) [default=no]: 
Would you like to create a new local network bridge? (yes/no) [default=yes]: 
What should the new bridge be called? [default=lxdbr0]: 
What IPv4 address should be used? (CIDR subnet notation, “auto” or “none”) [default=auto]: 
What IPv6 address should be used? (CIDR subnet notation, “auto” or “none”) [default=auto]: none
Would you like LXD to be available over the network? (yes/no) [default=no]: 
Would you like stale cached images to be updated automatically? (yes/no) [default=yes] 
Would you like a YAML &quot;lxd init&quot; preseed to be printed? (yes/no) [default=no]: 
</code></pre><p>Create a bridge profile:</p><pre><code># lxc profile create bridge
root@build:/media/sdb# cat bridge.profile 
config:
  linux.kernel_modules: ip_tables,ip6_tables,netlink_diag,nf_nat,overlay,br_netfilter
  raw.lxc: &quot;lxc.apparmor.profile=unconfined\nlxc.cap.drop= \nlxc.cgroup.devices.allow=a\nlxc.mount.auto=proc:rw sys:rw&quot;
  security.nesting: &quot;true&quot;
  security.privileged: &quot;true&quot;
description: Bridge LXD profile
devices:
  eth0:
    name: eth0
    nictype: bridged
    parent: br0
    type: nic
  root:
    path: /
    pool: default
    type: disk
name: bridge
root@build:/media/sdb# lxc  profile edit bridge &lt; bridge.profile 
root@build:/media/sdb# lxc profile list
+---------+---------+
|  NAME   | USED BY |
+---------+---------+
| bridge  | 0       |
+---------+---------+
| default | 0       |
+---------+---------+
</code></pre><p>Create a instance:</p><pre><code># lxc launch centos76 ko1 --profile bridge
Creating ko1
# lxc ls
+------+---------+-----------------------+------+------------+-----------+
| NAME |  STATE  |         IPV4          | IPV6 |    TYPE    | SNAPSHOTS |
+------+---------+-----------------------+------+------------+-----------+
| ko1  | RUNNING | 10.137.149.190 (eth0) |      | PERSISTENT | 0         |
+------+---------+-----------------------+------+------------+-----------+
</code></pre><h3 id=how-ko-works>How KO Works</h3><p>Bug fix1: conf/my.cnf mapping.<br>Bug fix2: could not running on lxc&rsquo;s docker-compose.</p><h3 id=on-adding-ubuntu>On adding Ubuntu</h3><p>Via following commands, we could use lxc for ubuntu20.04.</p><pre><code># qemu-img convert box.img box1.img
# kpartx -av box1.img 
# lvscan
# mount /dev/vgubuntu/root /mnt7/
# tar -czvf rootfs.tar.gz -C /mnt7 .
# vim metadata.yaml
architecture: &quot;x86_64&quot;
creation_date: 1600908919 # To get current date in Unix time, use `date +%s` command
properties:
architecture: &quot;x86_64&quot;
description: &quot;ubuntu20.04 for lxc&quot;
os: &quot;ubuntu&quot;
release: &quot;20.04&quot;
# tar czvf metadata.tar.gz metadata.yaml
# lxc image import metadata.tar.gz  rootfs.tar.gz --alias &quot;ubuntu20.04&quot;
</code></pre><h3 id=on-adding-storage-in-cluster>On adding storage in cluster</h3><p>Via following commands:</p><pre><code>lxc cluster list
# for getting the member name. 

lxc storage create fastPool dir source=/media/md0/lxd --target arm-a1
lxc storage create fastPool dir source=/media/md0/lxd --target arm-a2
lxc storage create fastPool dir source=/media/md0/lxd --target arm-a3
lxc storage create fastPool dir
</code></pre><h3 id=x86-working-tips>x86 working tips</h3><p>working tips for creating lxd cluster:</p><pre><code>sudo apt install linux-image-extra-virtual linux-generic
cat /proc/sys/net/bridge/bridge-nf-call-iptables
1
lxc profile copy default k8s
lxc profile edit k8s 
config:
  environment.TZ: Asia/Bangkok
  raw.lxc: |
    lxc.apparmor.profile=unconfined
    lxc.cgroup.devices.allow = a
    lxc.mount.auto=proc:rw sys:rw
    lxc.cap.drop=
  security.nesting: &quot;true&quot;
  security.privileged: &quot;true&quot;
description: Default LXD profile
devices:
  apparmor:
    path: /sys/module/apparmor/parameters/enabled
    source: /dev/null
    type: disk
  eth0:
    name: eth0
    nictype: bridged
    parent: br10
    type: nic
  hashsize:
    path: /sys/module/nf_conntrack/parameters/hashsize
    source: /dev/null
    type: disk
  kmsg:
    path: /dev/kmsg
    source: /dev/kmsg
    type: unix-char
  root:
    path: /
    pool: default
    type: disk
name: k8s
used_by:
- /1.0/containers/k1
- /1.0/containers/k2
- /1.0/containers/k3
lxc launch ubuntu:18.04 k1 -p k8s
</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2020/09/07/workingtiponaarchftp/>Workingtiponaarchftp</a></h1><span class=post-date>Sep 7, 2020<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=ftpd服务端>ftpd服务端</h3><p>加载镜像:</p><pre><code># docker load&lt;ftpd.tar
Loaded image: gists/pure-ftpd:arm64
# docker images | grep ftpd
gists/pure-ftpd                                                            arm64               1b3e76d8756b        3 months ago        5.77MB
</code></pre><p>运行以下命令, 创建一个pure-ftpd实例, 当前目录下的ftpd含有ftpd的配置文件(pureftpd)及存储目录(data):</p><pre><code># mkdir ftpd
# cd ftpd
# mkdir pureftpd data
# docker run -d --restart unless-stopped --name pure-ftpd  -e MIN_PASV_PORT=40000 -e MAX_PASV_PORT=40009 -p 21:21  -p 40000-40009:40000-40009  -v $(pwd)/pureftpd:/etc/pureftpd  -v $(pwd)/data:/home/ftpuser gists/pure-ftpd:arm64
</code></pre><p>运行以下命令配置pure-ftpd的权限，以及添加test用户，并刷新pure-ftpd本地配置文件:</p><pre><code> docker exec -it pure-ftpd chown ftpuser:ftpuser -R /home/ftpuser
 docker exec -it pure-ftpd pure-pw useradd test -m -u ftpuser -d /home/ftpuser/test
 docker exec -it pure-ftpd pure-pw mkdb
</code></pre><h3 id=客户端>客户端</h3><p>举winscp ftp连接为例, 新建一个ftp连接:</p><p><img src=./images/2020_09_07_10_25_02_615x286.jpg alt=./images/2020_09_07_10_25_02_615x286.jpg></p><p>直接在winscp里拖拉实现上传下载:</p><p><img src=./images/2020_09_07_10_26_36_990x327.jpg alt=./images/2020_09_07_10_26_36_990x327.jpg></p><p>进度:</p><p><img src=./images/2020_09_07_10_29_46_649x286.jpg alt=./images/2020_09_07_10_29_46_649x286.jpg></p></div><ul class=pagination><li class=page-item><a href=/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/page/33/ class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/>1</a></li><li class=page-item><a class=page-link href=/page/2/>2</a></li><li class=page-item><a class=page-link href=/page/3/>3</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/33/>33</a></li><li class="page-item active"><a class=page-link href=/page/34/>34</a></li><li class=page-item><a class=page-link href=/page/35/>35</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/229/>229</a></li><li class=page-item><a href=/page/35/ class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/229/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>