<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta name=generator content="Hugo 0.64.0"><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Dash &#183; Dash</title><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/hyde-a.css?ref=abc124"><link rel=stylesheet href="https://purplepalmdash.github.io/css/custom-additions.css?ref=abc124"><link rel=stylesheet href=https://purplepalmdash.github.io/css/highlight/googlecode.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/docco.min.css><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script type=text/javascript src=/js/html2canvas.js></script><script type=text/javascript>function genPostShot(){var rightNow=new Date();var imageName=rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");imageName+='.jpg'
html2canvas(document.getElementsByClassName('post'),{background:'#FFFFFF',onrendered:function(canvas){$('#test').attr('href',canvas.toDataURL("image/jpeg"));$('#test').attr('download',imageName);$('#test')[0].click();}});};</script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=apple-touch-icon-precomposed sizes=144x144 href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124"><link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel=icon><link href=%7balternate%20%7bRSS%20application/rss+xml%20%20index%20alternate%20%20false%20false%20true%20false%20false%200%7d%20/index.xml%20http://purplepalmdash.github.io/index.xml%7d rel=alternate type=application/rss+xml title="Dash &#183; Dash"><meta name=description content><meta name=keywords content="unix,virtualization,embedded,linux"></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><img src=http://purplepalmdash.github.io/images/mylogo.jpeg alt=gravatar><h1><a href=http://purplepalmdash.github.io/>很惭愧，就做了一点微小的工作</a></h1><a href=http://purplepalmdash.github.io/><p>Dash</p></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/post/>All Posts</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/technology/>Technology</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/life/>Life</a></li><li class=sidebar-nav-item><a href=http://purplepalmdash.github.io/categories/linuxtips/>LinuxTips</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/purplepalmdash><i class="fa fa-github-square fa-3x"></i></a><a href=https://cn.linkedin.com/in/yang-feipeng-1b909319><i class="fa fa-linkedin-square fa-3x"></i></a><a href=https://plus.google.com/u/0/106572959364703833986><i class="fa fa-google-plus-square fa-3x"></i></a><a href=https://www.facebook.com/yang.feipeng><i class="fa fa-facebook-square fa-3x"></i></a><a href=https://twitter.com/dashwillfly><i class="fa fa-twitter-square fa-3x"></i></a></li></ul></div></div><div class="content container"><div class=posts><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2018/04/18/kismatic110tips/>kismatic110tips</a></h1><span class=post-date>Apr 18, 2018<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=preparation>preparation</h3><p>Deployment machine, Download the packages:</p><pre><code># mkdir deploy
# cd deploy
# wget https://github.com/apprenda/kismatic/releases/download/v1.10.0/kismatic-v1.10.0-linux-amd64.tar.gz
# git clone https://github.com/apprenda/kismatic.git
# tar xzvf *.tar.gz;
# ls 
ansible  helm  kismatic  kismatic-master  kismatic-master.zip  kismatic-v1.10.0-linux-amd64.tar.gz  kubectl  provision
</code></pre><p>Target node(all-in-one), install python-pip, shadowsocks, redsocks, gcc, etc, for acrossing the fucking GFW!</p><h3 id=plan>plan</h3><p>plan the cluster</p><pre><code>./kismatic install plan
Plan your Kubernetes cluster:
=&gt; Number of etcd nodes [3]: 1
=&gt; Number of master nodes [2]: 1
=&gt; Number of worker nodes [3]: 1
=&gt; Number of ingress nodes (optional, set to 0 if not required) [2]: 0
=&gt; Number of storage nodes (optional, set to 0 if not required) [0]: 0
=&gt; Number of existing files or directories to be copied [0]: 0

Generating installation plan file template with: 
- 1 etcd nodes
- 1 master nodes
- 1 worker nodes
- 0 ingress nodes
- 0 storage nodes
- 0 files

Wrote plan file template to &quot;kismatic-cluster.yaml&quot;
Edit the plan file to further describe your cluster. Once ready, execute the &quot;install validate&quot; command to proceed.
</code></pre><p>An empty <code>kismatic-cluster.yaml</code> will be generated, later we will edit it.</p><h3 id=validate>validate</h3><p>validate with detailed information:</p><pre><code>./kismatic install validate -o raw
</code></pre><p>Error:</p><pre><code>ansible/bin/ansible-playbook -i ansible/inventory.ini -s ansible/playbooks/preflight.yaml --extra-vars @ansible/clustercatalog.yaml -vvvv
Traceback (most recent call last):
  File &quot;ansible/bin/ansible-playbook&quot;, line 36, in &lt;module&gt;
    import shutil
  File &quot;/usr/lib/python3.6/shutil.py&quot;, line 10, in &lt;module&gt;
    import fnmatch
  File &quot;/usr/lib/python3.6/fnmatch.py&quot;, line 14, in &lt;module&gt;
    import re
  File &quot;/usr/lib/python3.6/re.py&quot;, line 142, in &lt;module&gt;
    class RegexFlag(enum.IntFlag):
AttributeError: module 'enum' has no attribute 'IntFlag'
error running playbook: error running ansible: exit status 1
</code></pre><p>Seems because the python is python3 rather than python2.</p><p>Edit the python definition:</p><pre><code># vim ansible/bin/ansible-playbook
    #!/usr/bin/python2
</code></pre><p>Then your validation will be OK.</p><h3 id=install-apply>install apply</h3><p>Via following command:</p><pre><code># ./kismatic install apply
</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2018/04/12/workingtipsonplaywithk8s/>WorkingTipsOnPlayWithK8s</a></h1><span class=post-date>Apr 12, 2018<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=aim>Aim</h3><p>To Write an tutorial for colleagues for learning, they only have to open the
browser, by clicking then they could get an automated dev environment.</p><h3 id=environment>Environment</h3><p>play-with-kubernetes blog:</p><pre><code># git clone https://github.com/play-with-docker/play-with-kubernetes.github.io.git
# cd play-with-kubernetes.github.io/
# vim _config.yml
pwkurl: http://192.168.189.114
# docker-compose up
</code></pre><p>Then open your browser <code>http://192.168.189.114:4000</code>, and you will see the play-with-k8s webpages.</p><p>For using the local infrastructure, to configure the <code>play-with-docker</code> with
following steps:</p><pre><code># cd /root/go/src/github.com/play-with-docker/play-with-docker
# vim config/config.go
	//flag.StringVar(&amp;DefaultDinDImage, &quot;default-dind-image&quot;, &quot;franela/dind&quot;, &quot;Default DinD image to use if not specified otherwise&quot;)
	flag.StringVar(&amp;DefaultDinDImage, &quot;default-dind-image&quot;, &quot;franela/k8s&quot;, &quot;Default DinD image to use if not specified otherwise&quot;)
</code></pre><p>While the image we specified here could be the one you added your changes, but
default we will use <code>franela/k8s</code>.</p><p>The webpage is showed as:</p><p><img src=/images/2018_04_12_09_25_38_1242x708.jpg alt=/images/2018_04_12_09_25_38_1242x708.jpg></p></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2018/04/08/workingtipsonplaywithdocker2/>WorkingTipsOnPlayWithDocker2</a></h1><span class=post-date>Apr 8, 2018<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=migration>migration</h3><p>Really migrate this image into the inner intranet, without any internet
connection.</p><h3 id=registry-changing>Registry Changing</h3><p>You have to comment the proxy definition, or your registry instance will
restart frequently, thus your dind won&rsquo;t get working using registry.</p><pre><code># vim /root/data/config.yml
	#proxy:
		# remoteurl: https://registry-1.docker.io
# docker restart docker-registry-proxy-2
</code></pre><h3 id=systemd-definition>systemd definition</h3><p>Define following two systemd units:</p><pre><code># vim /etc/systemd/system/playwithdocker.service 
[Unit]
Description=playwithdocker
After=docker.service
Requires=docker.service

[Service]
Environment=GOPATH=/root/go/
ExecStart=/usr/bin/docker-compose -f /root/go/src/github.com/play-with-docker/play-with-docker/docker-compose.yml up -d

[Install]
WantedBy=multi-user.target
</code></pre><p>This unit will start blog service automatically.</p><pre><code># vim /etc/systemd/system/playwithdockerblog.service 
[Unit]
Description=playwithdockerblog
After=docker.service
Requires=docker.service

[Service]
ExecStart=/usr/bin/docker-compose -f /root/Code/play-with-docker.github.io/docker-compose.yml up -d

[Install]
WantedBy=multi-user.target
# systemctl enable playwithdocker.service
# systemctl enable playwithdockerblog.service
</code></pre><p>Next time the service will automatically start.</p><h3 id=offline-cssjs>Offline CSS/js</h3><p>bootstrap fonts:</p><pre><code># wget https://github.com/twbs/bootstrap/archive/v3.3.7.zip
# unzip bootstrap-3.3.7.zip
# cd fonts
# mkdir ~/Code/play-with-docker.github.io/_site/fonts/
# cp * ~/Code/play-with-docker.github.io/_site/fonts/
</code></pre><p>Then your image will display correctly.</p><p><img src=/images/2018_04_08_16_15_38_518x362.jpg alt=/images/2018_04_08_16_15_38_518x362.jpg></p><h3 id=google-fonts>Google Fonts</h3><p>Download the Fonts description from the website, then put all of the related
fonts under your local folder.</p><h3 id=dnsmasq>dnsmasq</h3><p>Download the rpm package via:</p><pre><code># yum install yum-plugin-downloadonly
# yum reinstall --downloadonly --downloaddir=/root/rpms dnsmasq
</code></pre><p>Transfer the package to intranet and install it. Then edit the configuration
file of dnsmasq:</p><pre><code># vim /etc/dnsmasq.conf
address=/192.192.189.114/192.192.189.114
# systemclt enable dnsmasq &amp;&amp; systemctl start dnsmasq
</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2018/04/07/workingtipsonplaywithdocker/>WorkingTipsOnPlayWithDocker</a></h1><span class=post-date>Apr 7, 2018<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=environment>Environment</h3><h4 id=qemu-image>Qemu Image</h4><p>Qemu image preparation:</p><pre><code># mkdir offline-play-with-docker
# cd offline-play-with-docker 
# qemu-img create -f qcow2 offline-play-with-docker.qcow2 200G
Formatting 'offline-play-with-docker.qcow2', fmt=qcow2 size=214748364800 cluster_size=65536 lazy_refcounts=off refcount_bits=16
</code></pre><h4 id=virt-manager-networking>Virt-manager Networking</h4><p>Network Name:</p><p><img src=/images/2018_04_07_10_33_34_346x179.jpg alt=/images/2018_04_07_10_33_34_346x179.jpg>
Definition of IPV4:</p><p><img src=/images/2018_04_07_10_34_29_338x431.jpg alt=/images/2018_04_07_10_34_29_338x431.jpg></p><p>Warning:</p><p><img src=/images/2018_04_07_10_34_50_505x137.jpg alt=/images/2018_04_07_10_34_50_505x137.jpg></p><p>Isolation(Could be adjust to isolated):</p><p><img src=/images/2018_04_07_10_35_35_386x231.jpg alt=/images/2018_04_07_10_35_35_386x231.jpg></p><p>Create vm and specify vmworks:</p><p><img src=/images/2018_04_07_13_35_07_540x268.jpg alt=/images/2018_04_07_13_35_07_540x268.jpg></p><p>Install CentOS 7.4, partition like following:</p><p><img src=/images/2018_04_07_13_38_50_484x224.jpg alt=/images/2018_04_07_13_38_50_484x224.jpg></p><p><img src=/images/2018_04_07_13_39_10_650x209.jpg alt=/images/2018_04_07_13_39_10_650x209.jpg></p><h3 id=system>System</h3><p>Set the hostname via:</p><p><img src=/images/2018_04_07_14_35_11_543x279.jpg alt=/images/2018_04_07_14_35_11_543x279.jpg></p><p>Install mate desktop(for debugging purpose):</p><pre><code># wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
# yum --enablerepo=epel -y groups install &quot;MATE Desktop&quot;
</code></pre><p>Install some tools:</p><pre><code># yum install -y vim wget python-pip gcc git nethogs
# pip install shadowsocks
# pip inststall --upgrade pip
# yum install -y libevent-devel
# build the redsocks for crossing the gfw!!!
</code></pre><p>Now you could cross the firewall for installing the go or other
staffs(crossing the gfw WILL let everything more smoothly).</p><p>Install docker-ce:</p><pre><code>#  yum install -y yum-utils \
  device-mapper-persistent-data \
  lvm2
# yum-config-manager \
    --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo
# yum install -y docker-ce
</code></pre><p>Install docker-compose via pip:</p><pre><code># pip install docker-compose
</code></pre><p>Start and enable docker:</p><pre><code># systemctl enable docker
# systemctl start docker
# docker swarm init
</code></pre><p>You have to run <code>docker swarm init</code>, or you won&rsquo;t login into the
play-with-docker.</p><p>Install golang:</p><pre><code># yum install -y golang
# mkdir ~/go
# vim ~/.bashrc
export GOPATH=/root/go
export PATH=$PATH:$GOPATH/bin
</code></pre><p>Create the directory and clone the source code:</p><pre><code># mkdir ~/Code
# cd Code
# git clone https://github.com/play-with-docker/play-with-docker.git
</code></pre><p>Build the <code>play-with-go</code>:</p><pre><code># go get -u github.com/golang/dep/cmd/dep
# which dep
/root/go/bin/dep
# cd ~/Code/play-with-docker/
# go get -v -d -t ./...
# cd /root/go/src/github.com/play-with-docker/play-with-docker
# dep ensure
</code></pre><h3 id=fixed-ip>Fixed IP</h3><p>Fixed IP address then we could manually build the dind adjusting to this IP
address:</p><p><img src=/images/2018_04_07_15_03_06_595x287.jpg alt=/images/2018_04_07_15_03_06_595x287.jpg></p><h3 id=local-registry>Local Registry</h3><p>In order to work offline, we have to use local repository.</p><pre><code># mkdir ~/data
# cd ~/data
# docker run -it --rm --entrypoint cat registry:2 /etc/docker/registry/config.yml &gt; config.yml
# vim config.yml
proxy:
      remoteurl: https://registry-1.docker.io
# mkdir ~/data/data
# docker run -d --restart=always -p 5000:5000 --name docker-registry-proxy-2 -v /root/data/config.yml:/etc/docker/registry/config.yml -v /root/data/data:/var/lib/registry registry:2
</code></pre><p>Now examine the docker registry running:</p><pre><code># docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
0ea38c808e8d        registry:2          &quot;/entrypoint.sh /etc…&quot;   2 seconds ago       Up 1 second         0.0.0.0:5000-&gt;5000/tcp   docker-registry-proxy-2
</code></pre><h3 id=build-dind>Build dind</h3><p>dind is <code>docker in docker</code>, which is a docker image for running docker
instance inside docker, we build it manually:</p><pre><code># vim
/root/go/src/github.com/play-with-docker/play-with-docker/dockerfiles/dind/daemon.json
    &quot;insecure-registries&quot;: [&quot;https://192.192.189.114:5000&quot;],
# vim
/root/go/src/github.com/play-with-docker/play-with-docker/dockerfiles/dind/Dockerfile
......
    /usr/sbin/sshd -o PermitRootLogin=yes -o PrintMotd=no 2&gt;/dev/null &amp;&amp; \
    dockerd --registry-mirror=http://192.192.189.114:5000 &amp;&gt;/docker.log 
......
</code></pre><p>Build the image:</p><pre><code># docker build -t franela/dind:latest .
# docker images | grep dind
franela/dind        latest              7832d23a42c7        About a minute ago   439MB
docker              stable-dind         d303f49c92a7        2 weeks ago          147MB
</code></pre><p>This dind image could use local registry, so we only need to sync once, then
we could let it running really offlinely.</p><h3 id=local-play-with-docker>Local play-with-docker</h3><p>Change the source code:</p><pre><code># cd /root/go/src/github.com/play-with-docker/play-with-docker
# vim handlers/bootstrap.go +64
- return false
+ return true
# vim config/config.go
 flag.StringVar(&amp;PlaygroundDomain, &quot;playground-domain&quot;, &quot;192.192.189.114&quot;, &quot;Domain to use for the playground&quot;)
</code></pre><p><img src=/images/2018_04_07_15_32_59_766x271.jpg alt=/images/2018_04_07_15_32_59_766x271.jpg></p><p>Make sure your dnsmasq is running, then edit the <code>/etc/dnsmasq.conf</code> via:</p><pre><code>.................
# Add local-only domains here, queries in these domains are answered
# from /etc/hosts or DHCP only.
#local=/localnet/
address=/192.192.189.114/192.192.189.114
address=/localhost/127.0.0.1
.................
</code></pre><p>Run <code>play-with-docker</code>:</p><pre><code># cd /root/go/src/github.com/play-with-docker/play-with-docker
# docker-compose up
</code></pre><p>Then use a browser to access this website:</p><p><img src=/images/2018_04_07_16_08_09_749x759.jpg alt=/images/2018_04_07_16_08_09_749x759.jpg></p><p>Examine the registry now:</p><p><img src=/images/2018_04_07_16_09_00_655x229.jpg alt=/images/2018_04_07_16_09_00_655x229.jpg></p><p>Then in host terminal, examine the downloaded registry cache:</p><pre><code>curl http://192.192.189.114:5000/v2/_catalog
{&quot;repositories&quot;:[&quot;library/alpine&quot;,&quot;library/ubuntu&quot;]}
</code></pre><h3 id=play-with-docker-classroom>play-with-docker classroom</h3><p>Clone the repository:</p><pre><code># cd ~/Code
# git clone https://github.com/play-with-docker/play-with-docker.github.io.git
# cd play-with-docker.github.io/
# vim _config.yml
pwdurl: http://192.192.189.114

# mkdir _site
# groupadd jekyll
# useradd jekyll -m -g jekyll
# chown jekyll:jekyll -R .
# docker-compose up
</code></pre><p>Now open the browser and see the result:</p><p><img src=/images/2018_04_07_16_49_34_794x532.jpg alt=/images/2018_04_07_16_49_34_794x532.jpg></p><h3 id=tips-for-docker-nginx>tips for docker-nginx</h3><pre><code># docker run --name docker-nginx -p 8333:80 -d -v /root/gcr:/usr/share/nginx/html jrelva/nginx-autoindex
root@playwithdocker:/etc/systemd/system# cat mynginx.service 
[Unit]
Description=mynginx
Requires=docker.service
After=docker.service

[Service]
Restart=always
ExecStart=/usr/bin/docker start -a docker-nginx
ExecStop=/usr/bin/docker stop -t 2 docker-nginx

[Install]
WantedBy=multi-user.target

</code></pre></div><div class=post><h1 class=post-title><a href=http://purplepalmdash.github.io/blog/2018/04/07/alpineoffline/>AlpineOffline</a></h1><span class=post-date>Apr 7, 2018<br><a class=a_cat href=http://purplepalmdash.github.io/categories/technology>Technology</a></span><h3 id=background>Background</h3><p>I want to run <code>play-with-docker</code> offline, so I have to setup the whole offline
environment. In chapter 2 of <code>play-with-docker</code>, it requires building image
using alpine, its command <code>apk add nodejs</code> requires internet-connection. In
order to let the whole tutorial working offlinely, I have to setup an Alpine
offline repository and let it working.</p><h3 id=vagrant-env>Vagrant Env</h3><p>The libvirt vagrant box is easy to download and run via following command:</p><pre><code># vagrant init generic/alpine37
# vagrant up --provider=libvirt
# vagrant ssh
# cat /etc/issue
Welcome to Alpine Linux 3.7
Kernel \r on an \m (\l)
</code></pre><h3 id=repository-server>Repository Server</h3><p>This server could reach internet, so it could get packages, and generate the
installation repository.</p><p>Take <code>nodejs</code> for example, I will create its offline installation reository in
this machine:</p><pre><code>#  apk add nodejs
</code></pre><p>This command will download all of the nodejs related package under
<code>/var/cache/apk</code>, then we could use these packages for installation:</p><pre><code># apk index -vU --allow-untrusted -o /etc/apk/cache/APKINDEX.tar.gz /etc/apk/cache/*.apk
</code></pre><p>Using following scripts for generating symbolic <code>cheating</code> apks for
installation:</p><pre><code>#!/bin/bash
for f in $( cd /etc/apk/cache &amp;&amp; ls *.apk ); do g=$(echo ${f:0:-13}.apk); cd /etc/apk/cache; ln -s $f $g; done
</code></pre><p>Your directory <code>/etc/apk/cache</code> will like following:</p><pre><code># ls -l -h | more
total 98612
-rw-r--r--    1 root     root       14.4K Apr  6 08:31 APKINDEX.tar.gz
lrwxrwxrwx    1 root     root          28 Apr  6 08:32 abuild-3.1.0-r3.apk -&gt; abuild-3.1.0-r3.e1614238.apk
-rw-r--r--    1 root     root       71.5K Apr  6 05:57 abuild-3.1.0-r3.e1614238.apk
lrwxrwxrwx    1 root     root          26 Apr  6 08:32 acct-6.6.4-r0.apk -&gt; acct-6.6.4-r0.f2caf476.apk
-rw-r--r--    1 root     root       57.7K Mar 22 17:31 acct-6.6.4-r0.f2caf476.apk
-rw-r--r--    1 root     root        1.6K Mar 22 17:31 alpine-base-3.7.0-r0.6e79e3bb.apk
lrwxrwxrwx    1 root     root          33 Apr  6 08:32 alpine-base-3.7.0-r0.apk -&gt; alpine-base-3.7.0-r0.6e79e3bb.apk
</code></pre><p>Using following commands for uploading repository to http server:</p><pre><code>scp -r /var/cache/apk/ xxx@192.168.122.1:/var/download/myapk/
</code></pre><p>In server <code>192.168.122.1</code>'s folder <code>/var/download/myapk</code>, do following
operation:</p><pre><code># ln -s x86_64 noarch
</code></pre><h3 id=client>Client</h3><p>In client, do following setting:</p><pre><code># vim  /etc/apk/repositories 
    #https://dl-3.alpinelinux.org/alpine/v3.7/main
    #https://mirror.leaseweb.com/alpine/v3.7/main
    http://192.168.122.1/myapk
</code></pre><p>Update the repository via following command:</p><pre><code># apk update --allow-untrusted
fetch http://192.168.122.1/myapk/x86_64/APKINDEX.tar.gz
OK: 110 distinct packages available
</code></pre><p>Install nodejs via following commands:</p><pre><code># apk add nodejs --allow-untrusted
(1/8) Installing nodejs-npm (8.9.3-r1)
(2/8) Installing c-ares (1.13.0-r0)
(3/8) Installing libcrypto1.0 (1.0.2o-r0)
(4/8) Installing http-parser (2.7.1-r1)
(5/8) Installing libssl1.0 (1.0.2o-r0)
(6/8) Installing libstdc++ (6.4.0-r5)
(7/8) Installing libuv (1.17.0-r0)
(8/8) Installing nodejs (8.9.3-r1)
Executing busybox-1.27.2-r8.trigger
OK: 228 MiB in 82 packages
</code></pre><h3 id=tbd>TBD</h3><p>You could add trusted signature to repository, but this will let you get the
signature firstly.</p></div><ul class=pagination><li class=page-item><a href=/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/page/74/ class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/>1</a></li><li class=page-item><a class=page-link href=/page/2/>2</a></li><li class=page-item><a class=page-link href=/page/3/>3</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/74/>74</a></li><li class="page-item active"><a class=page-link href=/page/75/>75</a></li><li class=page-item><a class=page-link href=/page/76/>76</a></li><li class="page-item disabled"><span aria-hidden=true>&nbsp;&mldr;&nbsp;</span></li><li class=page-item><a class=page-link href=/page/237/>237</a></li><li class=page-item><a href=/page/76/ class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/237/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div><script src=http://purplepalmdash.github.io/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>